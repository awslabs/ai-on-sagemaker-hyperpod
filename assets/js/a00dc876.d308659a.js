"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1618],{1470:(e,n,s)=>{s.d(n,{A:()=>v});var r=s(6540),t=s(4164),i=s(3104),a=s(6347),l=s(205),o=s(7485),c=s(1682),u=s(679);function d(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:s}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return d(e).map(({props:{value:e,label:n,attributes:s,default:r}})=>({value:e,label:n,attributes:s,default:r}))}(s);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const s=(0,a.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(t),(0,r.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(s.location.search);n.set(t,e),s.replace({...s.location,search:n.toString()})},[t,s])]}function g(e){const{defaultValue:n,queryString:s=!1,groupId:t}=e,i=h(e),[a,o]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i})),[c,d]=p({queryString:s,groupId:t}),[g,x]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,t]=(0,u.Dv)(n);return[s,(0,r.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),j=(()=>{const e=c??g;return m({value:e,tabValues:i})?e:null})();(0,l.A)(()=>{j&&o(j)},[j]);return{selectedValue:a,selectValue:(0,r.useCallback)(e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),x(e)},[d,x,i]),tabValues:i}}var x=s(2303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=s(4848);function y({className:e,block:n,selectedValue:s,selectValue:r,tabValues:a}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,i.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),i=a[t].value;i!==s&&(o(n),r(i))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;n=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;n=l[s]??l[l.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:r})=>(0,f.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{l.push(e)},onKeyDown:u,onClick:c,...r,className:(0,t.A)("tabs__item",j.tabItem,r?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function b({lazy:e,children:n,selectedValue:s}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===s);return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function S(e){const n=g(e);return(0,f.jsxs)("div",{className:(0,t.A)("tabs-container",j.tabList),children:[(0,f.jsx)(y,{...n,...e}),(0,f.jsx)(b,{...n,...e})]})}function v(e){const n=(0,x.A)();return(0,f.jsx)(S,{...e,children:d(e.children)},String(n))}},2412:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/ssh-b1eb45936e25f9a3483b2fcbf10df022.png"},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},9365:(e,n,s)=>{s.d(n,{A:()=>a});s(6540);var r=s(4164);const t={tabItem:"tabItem_Ymn6"};var i=s(4848);function a({children:e,hidden:n,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:n,children:e})}},9605:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"getting-started/orchestrated-by-slurm/ssh-into-hyperpod","title":"SSH Into Your HyperPod Cluster","description":"Overview","source":"@site/docs/00-getting-started/orchestrated-by-slurm/ssh-into-hyperpod.mdx","sourceDirName":"00-getting-started/orchestrated-by-slurm","slug":"/getting-started/orchestrated-by-slurm/ssh-into-hyperpod","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm/ssh-into-hyperpod","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"SSH Into Your HyperPod Cluster","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"SageMaker Studio Integration","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm/sagemaker-studio-integration"},"next":{"title":"Basic Slurm Commands","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm/slurm-basics"}}');var t=s(4848),i=s(8453),a=s(1470),l=s(9365);const o={title:"SSH Into Your HyperPod Cluster",sidebar_position:4},c=void 0,u={},d=[{value:"Overview",id:"overview",level:2},{value:"Why AWS Systems Manager (SSM)?",id:"why-aws-systems-manager-ssm",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Install SSM Session Manager Plugin",id:"step-1-install-ssm-session-manager-plugin",level:2},{value:"Step 2: Gather Cluster Information",id:"step-2-gather-cluster-information",level:2},{value:"Get Cluster ID",id:"get-cluster-id",level:3},{value:"Get Instance ID and Node Group Name",id:"get-instance-id-and-node-group-name",level:3},{value:"Step 3: Manual SSH Configuration",id:"step-3-manual-ssh-configuration",level:2},{value:"3.1 Generate SSH Key Pair (if needed)",id:"31-generate-ssh-key-pair-if-needed",level:3},{value:"3.2 Connect via SSM and Add Your Public Key",id:"32-connect-via-ssm-and-add-your-public-key",level:3},{value:"3.3 Configure SSH Client",id:"33-configure-ssh-client",level:3},{value:"3.4 Test SSH Connection",id:"34-test-ssh-connection",level:3},{value:"Step 4: Using the easy_ssh.sh Script (Automation Tool)",id:"step-4-using-the-easy_sshsh-script-automation-tool",level:2},{value:"Download and Use the Script",id:"download-and-use-the-script",level:3},{value:"IAM Permissions",id:"iam-permissions",level:2},{value:"Minimum Required Permissions",id:"minimum-required-permissions",level:3},{value:"Additional Permissions for Multi-User Environments",id:"additional-permissions-for-multi-user-environments",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Expected Output",id:"expected-output",level:3},{value:"Connecting to Your Cluster",id:"connecting-to-your-cluster",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Port Forwarding",id:"port-forwarding",level:3},{value:"SCP File Transfer",id:"scp-file-transfer",level:3},{value:"Multiple Node Access",id:"multiple-node-access",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{align:"center",children:(0,t.jsx)("img",{src:"/img/01-cluster/shell.svg",alt:"Cloud Shell",width:"128"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"SageMaker HyperPod clusters don't expose SSH ports directly to the internet for security reasons. Instead, you access cluster nodes through AWS Systems Manager (SSM) Session Manager, which provides secure, auditable access without requiring inbound firewall rules or bastion hosts."}),"\n",(0,t.jsx)(n.p,{children:"This guide covers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Why SSM is required and how it works"}),"\n",(0,t.jsx)(n.li,{children:"Setting up SSM with proper permissions"}),"\n",(0,t.jsx)(n.li,{children:"Manual SSH configuration"}),"\n",(0,t.jsx)(n.li,{children:"Using the easy_ssh.sh script to automate the process"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"why-aws-systems-manager-ssm",children:"Why AWS Systems Manager (SSM)?"}),"\n",(0,t.jsx)(n.p,{children:"AWS Systems Manager Session Manager provides several security and operational benefits:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No inbound ports"}),": Eliminates the need to open SSH ports (22) in security groups"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No bastion hosts"}),": Removes the complexity and cost of managing jump servers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Centralized access control"}),": Uses IAM policies for fine-grained access control"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Audit logging"}),": All session activity can be logged to CloudWatch and S3"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Encrypted connections"}),": All traffic is encrypted in transit"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No key management"}),": Can work without distributing SSH keys (though keys enable additional features)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Before connecting to your HyperPod cluster, ensure:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Your cluster status is ",(0,t.jsx)(n.code,{children:"InService"})]}),"\n",(0,t.jsx)(n.li,{children:"You have AWS CLI configured with appropriate credentials"}),"\n",(0,t.jsxs)(n.li,{children:["You have the required IAM permissions (see ",(0,t.jsx)(n.a,{href:"#iam-permissions",children:"IAM Permissions"})," section)"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["To configure AWS CLI credentials, refer to ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-authentication.html",children:"Authentication and access credentials for the AWS CLI"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"step-1-install-ssm-session-manager-plugin",children:"Step 1: Install SSM Session Manager Plugin"}),"\n",(0,t.jsx)(n.p,{children:"The Session Manager plugin enables the AWS CLI to start and end sessions that connect you to your managed instances."}),"\n",(0,t.jsx)("div",{style:{border:"1px solid #243343ff",borderRadius:"6px",padding:"16px",margin:"16px 0",backgroundColor:"#131c25ff"},children:(0,t.jsxs)(a.A,{children:[(0,t.jsx)(l.A,{value:"macos-arm64>",label:"macOS (arm64)",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/mac_arm64/sessionmanager-bundle.zip" -o "sessionmanager-bundle.zip"\nunzip sessionmanager-bundle.zip\nsudo ./sessionmanager-bundle/install -i /usr/local/sessionmanagerplugin -b /usr/local/bin/session-manager-plugin\n'})})}),(0,t.jsx)(l.A,{value:"macos-x86_64",label:"macOS (x86_64)",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/mac/sessionmanager-bundle.zip" -o "sessionmanager-bundle.zip"\nunzip sessionmanager-bundle.zip\nsudo ./sessionmanager-bundle/install -i /usr/local/sessionmanagerplugin -b /usr/local/bin/session-manager-plugin\n'})})}),(0,t.jsx)(l.A,{value:"Amazon-Linux-2",label:"Amazon Linux 2",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo yum install -y https://s3.amazonaws.com/session-manager-downloads/plugin/latest/linux_64bit/session-manager-plugin.rpm\n"})})}),(0,t.jsx)(l.A,{value:"Ubuntu",label:"Ubuntu (SageMaker CodeEditor)",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'sudo curl "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/ubuntu_64bit/session-manager-plugin.deb" -o "/tmp/session-manager-plugin.deb"\nsudo dpkg -i /tmp/session-manager-plugin.deb\n'})})})]})}),"\n",(0,t.jsx)(n.p,{children:"Verify the installation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"session-manager-plugin --version\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-2-gather-cluster-information",children:"Step 2: Gather Cluster Information"}),"\n",(0,t.jsx)(n.p,{children:"You'll need three pieces of information to connect to your HyperPod cluster:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Key"}),(0,t.jsx)(n.th,{children:"Example Value"}),(0,t.jsx)(n.th,{children:"How to obtain"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Cluster ID"}),(0,t.jsx)(n.td,{children:"q2vei6nzqldz"}),(0,t.jsxs)(n.td,{children:["Extract from cluster ARN in ",(0,t.jsx)(n.code,{children:"describe-cluster"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Instance ID"}),(0,t.jsx)(n.td,{children:"i-08982ccd4b6b34eb1"}),(0,t.jsxs)(n.td,{children:["From ",(0,t.jsx)(n.code,{children:"list-cluster-nodes"})," output"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Node Group Name"}),(0,t.jsx)(n.td,{children:"controller-machine"}),(0,t.jsxs)(n.td,{children:["From ",(0,t.jsx)(n.code,{children:"list-cluster-nodes"})," output"]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"get-cluster-id",children:"Get Cluster ID"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws sagemaker describe-cluster --cluster-name <your-cluster-name> --query 'ClusterArn' --output text\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The cluster ID is the last part of the ARN after the final ",(0,t.jsx)(n.code,{children:"/"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"get-instance-id-and-node-group-name",children:"Get Instance ID and Node Group Name"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws sagemaker list-cluster-nodes --cluster-name <your-cluster-name>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-3-manual-ssh-configuration",children:"Step 3: Manual SSH Configuration"}),"\n",(0,t.jsx)(n.p,{children:"This section shows how to manually configure SSH access, giving you full control over the setup process."}),"\n",(0,t.jsx)(n.h3,{id:"31-generate-ssh-key-pair-if-needed",children:"3.1 Generate SSH Key Pair (if needed)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ssh-keygen -t rsa -b 4096 -f "$HOME/.ssh/id_rsa" -N ""\n'})}),"\n",(0,t.jsx)(n.h3,{id:"32-connect-via-ssm-and-add-your-public-key",children:"3.2 Connect via SSM and Add Your Public Key"}),"\n",(0,t.jsx)(n.p,{children:"First, connect to your cluster using the raw SSM command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws ssm start-session \\\n    --target sagemaker-cluster:<cluster-id>_<node-group>-<instance-id> \\\n    --region <your-region>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once connected, you'll be logged in as root. Switch to the ubuntu user and add your public key:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Switch to ubuntu user\nsudo su - ubuntu\n\n# Create .ssh directory if it doesn\'t exist\nmkdir -p ~/.ssh\nchmod 700 ~/.ssh\n\n# Add your public key (replace with your actual public key)\necho "ssh-rsa AAAAB3NzaC1yc2EAAAA... your-public-key" >> ~/.ssh/authorized_keys\nchmod 600 ~/.ssh/authorized_keys\n\n# Exit the session\nexit\nexit\n'})}),"\n",(0,t.jsx)(n.h3,{id:"33-configure-ssh-client",children:"3.3 Configure SSH Client"}),"\n",(0,t.jsxs)(n.p,{children:["Add the following configuration to your local ",(0,t.jsx)(n.code,{children:"~/.ssh/config"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat <<EOF >> ~/.ssh/config\nHost <your-cluster-name>\n    User ubuntu\n    ProxyCommand sh -c \"aws ssm start-session --target sagemaker-cluster:<cluster-id>_<node-group>-<instance-id> --document-name AWS-StartSSHSession --parameters 'portNumber=%p'\"\nEOF\n"})}),"\n",(0,t.jsx)(n.p,{children:"Replace the placeholders with your actual values:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<your-cluster-name>"}),": A friendly name for your cluster"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<cluster-id>"}),": Your cluster ID"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<node-group>"}),": Your node group name"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<instance-id>"}),": Your instance ID"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"34-test-ssh-connection",children:"3.4 Test SSH Connection"}),"\n",(0,t.jsx)(n.p,{children:"Now you can connect using standard SSH:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ssh <your-cluster-name>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-4-using-the-easy_sshsh-script-automation-tool",children:"Step 4: Using the easy_ssh.sh Script (Automation Tool)"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"easy_ssh.sh"})," script automates the manual process described above. It's a convenience tool that:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Automatically retrieves cluster information"}),"\n",(0,t.jsx)(n.li,{children:"Sets up SSH configuration"}),"\n",(0,t.jsx)(n.li,{children:"Adds your public key to the cluster"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"download-and-use-the-script",children:"Download and Use the Script"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Download the script\ncurl -O https://raw.githubusercontent.com/aws-samples/awsome-distributed-training/main/1.architectures/5.sagemaker-hyperpod/easy-ssh.sh\nchmod +x easy-ssh.sh\n\n# Generate SSH key if you don\'t have one\nssh-keygen -t rsa -b 4096 -f "$HOME/.ssh/id_rsa" -N ""\n\n# Run the script\n./easy-ssh.sh -c <node-group> <cluster-name>\n'})}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"./easy-ssh.sh -c controller-machine ml-cluster\n"})}),"\n",(0,t.jsx)(n.p,{children:"The script will prompt you to:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Add the cluster to your ",(0,t.jsx)(n.code,{children:"~/.ssh/config"})]}),"\n",(0,t.jsx)(n.li,{children:"Add your SSH public key to the cluster"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'Answer "yes" to both prompts for the full automated setup.'}),"\n",(0,t.jsx)(n.h2,{id:"iam-permissions",children:"IAM Permissions"}),"\n",(0,t.jsx)(n.p,{children:"To access HyperPod clusters via SSM, users need specific IAM permissions. Here's a least-privilege policy example:"}),"\n",(0,t.jsx)(n.h3,{id:"minimum-required-permissions",children:"Minimum Required Permissions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Action": [\n                "ssm:StartSession"\n            ],\n            "Resource": [\n                "arn:aws:ssm:*:*:document/AWS-StartSSHSession",\n                "arn:aws:ssm:*:*:document/SSM-SessionManagerRunShell"\n            ]\n        },\n        {\n            "Effect": "Allow",\n            "Action": [\n                "ssm:StartSession"\n            ],\n            "Resource": "arn:aws:ssm:*:*:managed-instance/sagemaker-cluster:*",\n            "Condition": {\n                "StringLike": {\n                    "ssm:resourceTag/sagemaker:cluster-name": "<your-cluster-name>"\n                }\n            }\n        },\n        {\n            "Effect": "Allow",\n            "Action": [\n                "ssm:TerminateSession",\n                "ssm:ResumeSession"\n            ],\n            "Resource": "arn:aws:ssm:*:*:session/${aws:username}-*"\n        },\n        {\n            "Effect": "Allow",\n            "Action": [\n                "sagemaker:DescribeCluster",\n                "sagemaker:ListClusterNodes"\n            ],\n            "Resource": "arn:aws:sagemaker:*:*:cluster/<your-cluster-name>"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"additional-permissions-for-multi-user-environments",children:"Additional Permissions for Multi-User Environments"}),"\n",(0,t.jsx)(n.p,{children:"If you're setting up access for multiple users, consider these additional permissions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Action": [\n                "ssm:SendCommand"\n            ],\n            "Resource": [\n                "arn:aws:ssm:*:*:managed-instance/sagemaker-cluster:*",\n                "arn:aws:ssm:*:*:document/AWS-RunShellScript"\n            ],\n            "Condition": {\n                "StringEquals": {\n                    "ssm:resourceTag/sagemaker:cluster-name": "<your-cluster-name>"\n                }\n            }\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"Security Best Practices",type:"warning",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Principle of least privilege"}),": Only grant the minimum permissions required"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Resource-specific access"}),": Use conditions to limit access to specific clusters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Regular audits"}),": Review and rotate access permissions regularly"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session logging"}),": Enable CloudWatch logging for all SSM sessions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User isolation"}),": Consider using separate IAM roles for different user groups"]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cluster not accessible:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"An error occurred (TargetNotConnected) when calling the StartSession operation\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Verify cluster status is ",(0,t.jsx)(n.code,{children:"InService"}),": ",(0,t.jsx)(n.code,{children:"aws sagemaker describe-cluster --cluster-name <cluster-name>"})]}),"\n",(0,t.jsx)(n.li,{children:"Check your IAM permissions"}),"\n",(0,t.jsx)(n.li,{children:"Ensure you're using the correct region"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"RunAs user errors:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Unable to start command: failed to start pty since RunAs user <username> does not exist\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"This occurs when SSM Run-as-user is configured but the user doesn't exist on the target"}),"\n",(0,t.jsx)(n.li,{children:"Disable Run-as-user in SSM preferences or create the user on the target instance"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"SSH connection refused:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ssh: connect to host <cluster-name> port 22: Connection refused\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Verify your SSH configuration in ",(0,t.jsx)(n.code,{children:"~/.ssh/config"})]}),"\n",(0,t.jsx)(n.li,{children:"Ensure the ProxyCommand is correctly formatted"}),"\n",(0,t.jsx)(n.li,{children:"Test the underlying SSM connection first"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"expected-output",children:"Expected Output"}),"\n",(0,t.jsx)(n.p,{children:"When the script runs successfully, you'll see output similar to:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"=================================================\n==== \ud83d\ude80 HyperPod Cluster Easy SSH Script! \ud83d\ude80 ====\n=================================================\nCluster id: hyiyx2wvois6\nInstance id: i-0744d68e03703e483\nNode Group: controller-machine\nWould you like to add ml-cluster to  ~/.ssh/config (yes/no)?\n> yes\n\u2705 adding ml-cluster to  ~/.ssh/config:\n2. Do you want to add your SSH public key ~/.ssh/id_rsa.pub to the cluster (yes/no)?\n> yes\nAdding ... ssh-rsa ...\n\n\u2705 Your SSH public key ~/.ssh/id_rsa.pub has been added to the cluster.\n\nNow you can run:\n$ ssh ml-cluster\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connecting-to-your-cluster",children:"Connecting to Your Cluster"}),"\n",(0,t.jsx)(n.p,{children:"After completing either the manual setup or using the easy_ssh.sh script, you can connect to your cluster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ssh <your-cluster-name>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You'll be connected as the ",(0,t.jsx)(n.code,{children:"ubuntu"})," user and can start running your workloads."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Cluster Screenshot",src:s(2412).A+"",width:"2236",height:"462"})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"port-forwarding",children:"Port Forwarding"}),"\n",(0,t.jsx)(n.p,{children:"You can forward ports through the SSM tunnel for accessing services running on your cluster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ssh -L 8080:localhost:8080 <your-cluster-name>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scp-file-transfer",children:"SCP File Transfer"}),"\n",(0,t.jsx)(n.p,{children:"Copy files to/from your cluster using SCP:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Copy file to cluster\nscp local-file.txt <your-cluster-name>:~/\n\n# Copy file from cluster  \nscp <your-cluster-name>:~/remote-file.txt ./\n"})}),"\n",(0,t.jsx)(n.h3,{id:"multiple-node-access",children:"Multiple Node Access"}),"\n",(0,t.jsx)(n.p,{children:"To access different nodes in your cluster, you can create separate SSH configurations for each node by following the manual setup process with different instance IDs."})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);