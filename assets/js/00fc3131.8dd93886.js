"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7418],{1021:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/11-cfn-output-8c3efcc7b69e9d7df4cfeb559a68cfc5.png"},2315:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/10-filesystem-check-7f7bcab96def312ec40a3bd59f75254f.png"},3177:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/09-studio-user-be6188e930c0cd2a2df29c4cb4641712.png"},3707:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/01-studio-hyperpod-architecture-02b8b4219eb9818c6bfe4961f2ede093.png"},6995:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/08-fsx-partitioned-519ab511bdcbb6a8abaf7ca92f92b188.png"},7006:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/06-get-pod-703e3f755c6bdfe32b711b44a088a691.png"},7477:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"getting-started/orchestrated-by-eks/sagemaker-studio-integration","title":"SageMaker Studio Integration","description":"This guide provides step-by-step instructions for setting up Amazon SageMaker Studio with Hyperpod on Amazon EKS, including FSx Lustre storage configuration.","source":"@site/docs/00-getting-started/orchestrated-by-eks/sagemaker-studio-integration.md","sourceDirName":"00-getting-started/orchestrated-by-eks","slug":"/getting-started/orchestrated-by-eks/sagemaker-studio-integration","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/sagemaker-studio-integration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"SageMaker Studio Integration","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Reviewing the cluster console","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Reviewing the cluster console"},"next":{"title":"Verifying cluster connection to EKS","permalink":"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Verifying cluster connection to EKS"}}');var r=s(4848),i=s(8453);const o={title:"SageMaker Studio Integration",sidebar_position:3},a="SageMaker Studio + Hyperpod Integration Guide",c={},l=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"EKS Cluster Setup",id:"eks-cluster-setup",level:2},{value:"FSx for Lustre Configuration",id:"fsx-for-lustre-configuration",level:2},{value:"SageMaker Studio Domain Setup",id:"sagemaker-studio-domain-setup",level:2},{value:"SageMaker Studio IDE Configuration",id:"sagemaker-studio-ide-configuration",level:2},{value:"Setup EKS Access Entry",id:"setup-eks-access-entry",level:2},{value:"Setup EKS Cluster connection",id:"setup-eks-cluster-connection",level:2},{value:"Optional: Setup Hyperpod Task Governance and CloudWatch Observability",id:"optional-setup-hyperpod-task-governance-and-cloudwatch-observability",level:2},{value:"Optional: MLFlow Setup",id:"optional-mlflow-setup",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"sagemaker-studio--hyperpod-integration-guide",children:"SageMaker Studio + Hyperpod Integration Guide"})}),"\n",(0,r.jsx)(n.p,{children:"This guide provides step-by-step instructions for setting up Amazon SageMaker Studio with Hyperpod on Amazon EKS, including FSx Lustre storage configuration."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SageMaker Studio with Hyperpod integration",src:s(3707).A+"",width:"1908",height:"940"})}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#prerequisites",children:"Prerequisites"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#eks-cluster-setup",children:"EKS Cluster Setup"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#fsx-for-lustre-configuration",children:"FSx for Lustre Configuration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#sagemaker-studio-domain-setup",children:"SageMaker Studio Domain Setup"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#sagemaker-studio-ide-configuration",children:"SageMaker Studio IDE Configuration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#setup-eks-access-entry",children:"Setup EKS Access Entry"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#setup-eks-cluster-connection",children:"Setup EKS Cluster connection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#optional-setup-hyperpod-task-governance-and-cloudwatch-observability",children:"Optional: Setup Hyperpod Task Governance and CloudWatch Observability"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#optional-mlflow-setup",children:"Optional: MLFlow Setup"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before starting, ensure you have:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"AWS CLI configured with appropriate permissions"}),"\n",(0,r.jsx)(n.li,{children:"Access to AWS Management Console"}),"\n",(0,r.jsx)(n.li,{children:"Familiarity with Amazon EKS, SageMaker, and FSx Lustre"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"eks-cluster-setup",children:"EKS Cluster Setup"}),"\n",(0,r.jsx)(n.p,{children:"To create an Amazon EKS cluster, and setup a SageMaker Hyperpod one, you can follow one of these steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Option 1: ",(0,r.jsx)(n.a,{href:"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/initial-cluster-setup",children:"Initial Cluster Setup"})]}),"\n",(0,r.jsx)(n.li,{children:"Option 2: Using CloudFormation (see Infrastructure as Code section)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fsx-for-lustre-configuration",children:"FSx for Lustre Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["To create an Amazon FSx for Lustre volume, for being used by both EKS pods and SageMaker Studio, you can follow the steps ",(0,r.jsx)(n.a,{href:"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set%20up%20your%20shared%20file%20system",children:"Set up your shared file system"}),". The choice of Dynamic vs Static provisioning is yours!"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"sagemaker-studio-domain-setup",children:"SageMaker Studio Domain Setup"}),"\n",(0,r.jsxs)(n.p,{children:["You can deploy the CloudFormation template from the ",(0,r.jsx)(n.a,{href:"https://github.com/aws-samples/awsome-distributed-training/blob/main/1.architectures/7.sagemaker-hyperpod-eks/cfn-templates/sagemaker-studio-fsx-stack.yaml",children:"awsome-distributed-training repository"}),", which creates the following resources:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"SageMaker Studio domain"}),"\n",(0,r.jsxs)(n.li,{children:["Lifecycle configurations for installing necessary packages for Studio IDE, such as ",(0,r.jsx)(n.em,{children:"kubectl"})," and ",(0,r.jsx)(n.em,{children:"jq"}),". Lifecycle configurations will be created for both JupyterLab and Code Editor"]}),"\n",(0,r.jsxs)(n.li,{children:["A Lambda function that:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Associates the created ",(0,r.jsx)(n.code,{children:"security-group-for-inbound-nfs"})," security group to the Studio domain"]}),"\n",(0,r.jsxs)(n.li,{children:["Associates the ",(0,r.jsx)(n.code,{children:"security-group-for-inbound-nfs"})," security group to the FSx for Lustre ENIs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Optional"}),": If  ",(0,r.jsx)(n.strong,{children:"SharedFSx"})," is set to ",(0,r.jsx)(n.strong,{children:"True"}),", creates the partition ",(0,r.jsx)(n.em,{children:"shared"})," in the FSx for Lustre volume, and associates it to the Studio domain"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Shared FSx Partition",src:s(9938).A+"",width:"1604",height:"658"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.strong,{children:"SharedFSx"})," is set to ",(0,r.jsx)(n.strong,{children:"False"}),", a Lambda function that:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Creates the partition ",(0,r.jsx)(n.em,{children:"/{user_profile_name}"}),", and associates it to the Studio user profile"]}),"\n",(0,r.jsx)(n.li,{children:"Creates an Event bridge rule that invokes the previously defined Lambda function each time a new user is created."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Partitioned FSx",src:s(6995).A+"",width:"1576",height:"652"})}),"\n",(0,r.jsx)(n.p,{children:"The CloudFormation template requires the following parameters:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"EKSClusterName: Name of the EKS Cluster"}),"\n",(0,r.jsx)(n.li,{children:"ExistingFSxLustreId: Id of the created FSx for Lustre volume"}),"\n",(0,r.jsx)(n.li,{children:"FSxClaimName: Name of the claim created for the FSx for Lustre volume"}),"\n",(0,r.jsx)(n.li,{children:"ExistingVpcId: Dropdown menu for selecting the EKS cluster VPC"}),"\n",(0,r.jsxs)(n.li,{children:["ExistingSubnetIds: Dropdown menu for selecting the EKS cluster ",(0,r.jsx)(n.strong,{children:"Private Subnet IDs"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"Important",type:"warning",children:[(0,r.jsxs)(n.p,{children:["While specifying the ",(0,r.jsx)(n.code,{children:"ExistingSubnetIds"}),", please pass in only the subnet IDs associated with your ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"HyperPod"})})," cluster, and not your EKS cluster. You can find this in your environment variables (",(0,r.jsx)(n.code,{children:"env_vars"}),") that you used to create the cluster, as ",(0,r.jsx)(n.code,{children:"PRIVATE_SUBNET_ID"}),". Alternatively, you can check your console for private subnets with names ",(0,r.jsx)(n.code,{children:"<PREFIX> Private Subnet 1"})," (correct) vs. ",(0,r.jsx)(n.code,{children:"<PREFIX> EKS Cluster Private Subnet 1"}),"."]}),(0,r.jsx)(n.p,{children:"Do not attempt to delete the CloudFormation stack before all EFA network interfaces have been removed, as they are dependencies of your private subnet and will preclude it from being deleted as a stack resource. This may take several minutes as the HyperPod nodes are shut down."})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"sagemaker-studio-ide-configuration",children:"SageMaker Studio IDE Configuration"}),"\n",(0,r.jsx)(n.p,{children:"As an admin user, once your SageMaker Studio Domain is provisioned, you may go in and create users as you see fit."}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This step ",(0,r.jsx)(n.em,{children:"DOES NOT"})," assume that you already have a Studio Domain. To create one, check out the next section titled ",(0,r.jsx)(n.strong,{children:'"SageMaker Studio Domain Setup"'}),".\n",(0,r.jsx)(n.img,{alt:"alt text",src:s(3177).A+"",width:"2404",height:"792"})]})}),"\n",(0,r.jsx)(n.p,{children:"You can now select your preferred IDE from SageMaker Studio."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SageMaker Studio Home",src:s(9146).A+"",width:"2878",height:"1516"})}),"\n",(0,r.jsx)(n.p,{children:"For the purpose of this workshop, we are going to create a Code Editor environment."}),"\n",(0,r.jsx)(n.p,{children:"From the top-left menu:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Click on ",(0,r.jsx)(n.strong,{children:"Code Editor"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click on ",(0,r.jsx)(n.strong,{children:"Create Code Editor Space"})]}),"\n",(0,r.jsx)(n.li,{children:"Enter a name"}),"\n",(0,r.jsxs)(n.li,{children:["Click on ",(0,r.jsx)(n.strong,{children:"Create Space"})]}),"\n",(0,r.jsxs)(n.li,{children:["From the ",(0,r.jsx)(n.strong,{children:"Attach custom filesystem - optional"})," dropdown menu, select the FSx for Lustre volume"]}),"\n",(0,r.jsxs)(n.li,{children:["From the ",(0,r.jsx)(n.strong,{children:"Lifecycle configuration"})," dropdown menu, select the available lifecycle configuration"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Code Editor setup",src:s(8960).A+"",width:"2338",height:"1230"})}),"\n",(0,r.jsxs)(n.p,{children:["Click on ",(0,r.jsx)(n.strong,{children:"Run Space"}),". Wait until the space is created, then click ",(0,r.jsx)(n.strong,{children:"Open Code Editor"})]}),"\n",(0,r.jsxs)(n.p,{children:["To verify that your file system was mounted, you can check if you have a path mounted in the Code Editor space ",(0,r.jsx)(n.code,{children:"custom-file-system/fsx_lustre/<FSX_ID>"}),":"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Code Editor setup",src:s(2315).A+"",width:"2880",height:"1522"})}),"\n",(0,r.jsx)(n.p,{children:"You can also run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"df -h\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If you set ",(0,r.jsx)(n.code,{children:"SharedFSx"})," to ",(0,r.jsx)(n.code,{children:"False"}),", you can verify separate partitions for two users.\nExample output from user1:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Filesystem                      Size  Used Avail Use% Mounted on\noverlay                          37G  494M   37G   2% /\ntmpfs                            64M     0   64M   0% /dev\ntmpfs                           1.9G     0  1.9G   0% /sys/fs/cgroup\nshm                             392M     0  392M   0% /dev/shm\n/dev/nvme1n1                    5.0G  529M  4.5G  11% /home/sagemaker-user\n/dev/nvme0n1p1                  180G   31G  150G  18% /opt/.sagemakerinternal\n10.1.53.46@tcp:/ylacfb4v/aman1  1.2T  7.5M  1.2T   1% /mnt/custom-file-systems/fsx_lustre/fs-0104f3de83efe0f33\n127.0.0.1:/                     8.0E     0  8.0E   0% /mnt/custom-file-systems/efs/fs-052756a07c3a5ba97_fsap-0b5e6e7c68f22fee3\ntmpfs                           1.9G     0  1.9G   0% /proc/acpi\ntmpfs                           1.9G     0  1.9G   0% /sys/firmware\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example output from user2:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Filesystem                      Size  Used Avail Use% Mounted on\noverlay                          37G  478M   37G   2% /\ntmpfs                            64M     0   64M   0% /dev\ntmpfs                           1.9G     0  1.9G   0% /sys/fs/cgroup\nshm                             392M     0  392M   0% /dev/shm\n/dev/nvme0n1p1                  180G   31G  150G  18% /opt/.sagemakerinternal\n/dev/nvme1n1                    5.0G  529M  4.5G  11% /home/sagemaker-user\n127.0.0.1:/                     8.0E     0  8.0E   0% /mnt/custom-file-systems/efs/fs-052756a07c3a5ba97_fsap-0a323a3e5a27e1bdc\n10.1.53.46@tcp:/ylacfb4v/aman2  1.2T  7.5M  1.2T   1% /mnt/custom-file-systems/fsx_lustre/fs-0104f3de83efe0f33\ntmpfs                           1.9G     0  1.9G   0% /proc/acpi\ntmpfs                           1.9G     0  1.9G   0% /sys/firmware\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The difference here is the mountpoint for FSxl (",(0,r.jsx)(n.code,{children:"ylacfb4v"}),") has separate partitions set up. You can then ",(0,r.jsx)(n.code,{children:"cd /mnt/custom-file-systems/fsx_lustre/fs-0104f3de83efe0f33"})," and write from each user and verify that the other user isn't able to see those files!"]}),"\n",(0,r.jsxs)(n.p,{children:["Alternatively, if you set ",(0,r.jsx)(n.code,{children:"SharedFSx"})," to ",(0,r.jsx)(n.code,{children:"True"}),", you can check the the mount using ",(0,r.jsx)(n.code,{children:"df -h"}),", and it will show something like:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Filesystem                       Size  Used Avail Use% Mounted on\noverlay                           37G  478M   37G   2% /\ntmpfs                             64M     0   64M   0% /dev\ntmpfs                            1.9G     0  1.9G   0% /sys/fs/cgroup\nshm                              392M     0  392M   0% /dev/shm\n/dev/nvme0n1p1                   180G   31G  150G  18% /opt/.sagemakerinternal\n/dev/nvme1n1                     5.0G  529M  4.5G  11% /home/sagemaker-user\n10.1.53.46@tcp:/ylacfb4v/shared  1.2T  7.5M  1.2T   1% /mnt/custom-file-systems/fsx_lustre/fs-0104f3de83efe0f33\n127.0.0.1:/                      8.0E     0  8.0E   0% /mnt/custom-file-systems/efs/fs-0e16e272aba907ad3_fsap-08ae9b9f68be028d7\ntmpfs                            1.9G     0  1.9G   0% /proc/acpi\ntmpfs                            1.9G     0  1.9G   0% /sys/firmware\n"})}),"\n",(0,r.jsxs)(n.p,{children:["with the ",(0,r.jsx)(n.code,{children:"/shared"})," partition."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"setup-eks-access-entry",children:"Setup EKS Access Entry"}),"\n",(0,r.jsx)(n.p,{children:"To allow users to deploy training workloads on Hyperpod, you should setup EKS Access Entry for the SageMaker Studio IAM Role."}),"\n",(0,r.jsx)(n.p,{children:"Run the following commands:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export EKS_CLUSTER_NAME=<YOUR_CLUSTER_NAME>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.strong,{children:"YOUR_CLUSTER_NAME"})," With the name of the EKS cluster."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'CALLER_IDENTITY=$(aws sts get-caller-identity --output json)\nACCOUNT_ID=$(echo "$CALLER_IDENTITY" | jq -r .Account)\nUSER_ARN=$(echo "$CALLER_IDENTITY" | jq -r .Arn)\nPRINCIPAL_TYPE=$(echo "$USER_ARN" | cut -d\':\' -f6 | cut -d\'/\' -f1)\nUSER_NAME=$(echo "$USER_ARN" | cut -d\'/\' -f2)\nROLE_NAME=$(echo "$USER_ARN" | cut -d\'/\' -f2)\nUSER_ARN="arn:aws:iam::${ACCOUNT_ID}:role/${ROLE_NAME}"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Create an EKS Access Entry:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'aws eks create-access-entry \\\n  --cluster-name "$EKS_CLUSTER_NAME" \\\n  --principal-arn "$USER_ARN" \\\n  --type "STANDARD"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Associate an IAM policy to the access entry:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'aws eks associate-access-policy \\\n  --cluster-name "$EKS_CLUSTER_NAME" \\\n  --principal-arn "$USER_ARN" \\\n  --policy-arn "arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy" \\\n  --access-scope \'{"type": "cluster"}\'\n'})}),"\n",(0,r.jsx)(n.p,{children:"You are now ready to setup the cluster connection."}),"\n",(0,r.jsx)(n.p,{children:"If you run"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get svc\n"})}),"\n",(0,r.jsx)(n.p,{children:"you should see an output similar to:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME             TYPE        CLUSTER-IP   EXTERNAL-IP PORT(S)   AGE\nsvc/kubernetes   ClusterIP   10.100.0.1   <none>      443/TCP   1m\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"setup-eks-cluster-connection",children:"Setup EKS Cluster connection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Follow the steps in ",(0,r.jsx)(n.a,{href:"/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Verifying%20cluster%20connection%20to%20EKS",children:"Verifying cluster connection to EKS"}),' until "Verify helm Chart Installation".']}),"\n",(0,r.jsx)(n.p,{children:"You should now be able to operate with the EKS cluster."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SageMaker Studio with Hyperpod integration",src:s(7006).A+"",width:"2880",height:"1392"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"optional-setup-hyperpod-task-governance-and-cloudwatch-observability",children:"Optional: Setup Hyperpod Task Governance and CloudWatch Observability"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["For Hyperpod Task Governance, If not previously done, follow the steps in ",(0,r.jsx)(n.a,{href:"/ai-on-sagemaker-hyperpod/docs/add-ons/Task%20Governance/Task%20Governance%20for%20Training",children:"Task Governance"})]}),"\n",(0,r.jsxs)(n.li,{children:["For CloudWatch Observability insights, if not done previously, follow the steps in ",(0,r.jsx)(n.a,{href:"/ai-on-sagemaker-hyperpod/docs/add-ons/Observability/Container%20Insights/",children:"Container Insights"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Run the following command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export EKS_CLUSTER_NAME=<EKS_CLUSTER_NAME>\nexport EKS_CLUSTER_EXECUTION_ROLE_NAME=<EKS_CLUSTER_EXECUTION_ROLE_NAME>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Replace:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"EKS_CLUSTER_NAME"}),": EKS Cluster name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"EKS_CLUSTER_EXECUTION_ROLE_NAME"}),": IAM Role name used by the EKS Cluster"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws iam attach-role-policy \\\n  --role-name $EKS_CLUSTER_EXECUTION_ROLE_NAME \\\n  --policy-arn arn:aws:iam::aws:policy/CloudWatchAgentServerPolicy\n"})}),"\n",(0,r.jsx)(n.p,{children:"Optional: You can install the CloudWatch adds-on through AWS SDK:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws eks create-addon \\\n--addon-name amazon-cloudwatch-observability \\\n--cluster-name $EKS_CLUSTER_NAME\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For additional information, please refer to ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Container-Insights-upgrade-enhanced.html",children:"Upgrading to Container Insights with enhanced observability for Amazon EKS in CloudWatch"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"optional-mlflow-setup",children:"Optional: MLFlow Setup"}),"\n",(0,r.jsxs)(n.p,{children:["Follow the AWS documentation: ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/eks/latest/userguide/associate-service-account-role.html",children:"Assign IAM roles to Kubernetes service accounts"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note"}),": You can perform these steps from SageMaker Studio. The Studio Domain execution role is configured with the necessary IAM Policy. If you need to edit the role, ensure these steps are performed by an Admin user."]}),"\n",(0,r.jsx)(n.p,{children:"Run the following commands:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export EKS_CLUSTER_NAME=<EKS_CLUSTER_NAME>\nexport EKS_MLFLOW_POLICY_ARN=<EKS_MLFLOW_POLICY_ARN>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Replace:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"EKS_CLUSTER_NAME"}),": EKS Cluster name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"EKS_MLFLOW_POLICY_ARN"}),": MLflow policy ARN from the output of the Cloudformation template"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SageMaker Studio CFN Output",src:s(1021).A+"",width:"1552",height:"1114"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"eksctl create iamserviceaccount \\\n  --name eks-hyperpod-sa \\\n  --namespace default \\\n  --cluster $EKS_CLUSTER_NAME \\\n  --role-name eks-hyperpod-mlflow-role \\\n  --attach-policy-arn $EKS_MLFLOW_POLICY_ARN \\\n  --approve\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f - <<EOF\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: eks-hyperpod-sa\n  namespace: default\nEOF\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var t=s(6540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}},8960:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/03-codeditor-fsx-58e0ed3cec176616b5e856742f7e528f.png"},9146:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/02-studio-home-cee67b3fd29407afc9abaec315dbc340.png"},9938:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/07-fsx-shared-ddcbaa129d1adf04cc3d4f34c40991a7.png"}}]);