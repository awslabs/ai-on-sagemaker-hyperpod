"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4354],{2081:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>u,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Tips/Common/mount-additional-fsx","title":"Mount additional FSx Filesystem","description":"Ok, so let\'s say you want to mount an additional FSx Lustre filesystem, to do this you\'ll need to modify your lifecycle scripts:","source":"@site/docs/08-Tips/Common/13-mount-additional-fsx.md","sourceDirName":"08-Tips/Common","slug":"/Tips/Common/mount-additional-fsx","permalink":"/docs/Tips/Common/mount-additional-fsx","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"title":"Mount additional FSx Filesystem","weight":53},"sidebar":"tutorialSidebar","previous":{"title":"Link FSx Filesystems to Amazon S3 (Data Repository Association)","permalink":"/docs/Tips/Common/link-fsx-to-S3"},"next":{"title":"Downsize existing FSx Volume","permalink":"/docs/Tips/Common/downsize-fsx"}}');var o=s(4848),i=s(8453);const u={title:"Mount additional FSx Filesystem",weight:53},d=void 0,a={},c=[];function r(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Ok, so let's say you want to mount an additional FSx Lustre filesystem, to do this you'll need to modify your lifecycle scripts:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Start by modifying the ",(0,o.jsx)(n.code,{children:"lifecycle_script.py"})," to add your additional FSx filesystems. These can be mounted by adding in lines on ",(0,o.jsx)(n.a,{href:"https://github.com/aws-samples/awsome-distributed-training/blob/78d906651b1de4fb5c068cd157c6d60331c44ad8/1.architectures/5.sagemaker-hyperpod/LifecycleScripts/base-config/lifecycle_script.py#L153",children:"lifecycle_script.py#L153"})," like so. Note you may need to remove the original mount (",(0,o.jsx)(n.code,{children:"/fsx"}),") lines so your mount paths don't conflict."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-diff",children:'-    fsx_dns_name, fsx_mountname = params.fsx_settings\n-    if fsx_dns_name and fsx_mountname:\n-        print(f"Mount fsx: {fsx_dns_name}. Mount point: {fsx_mountname}")\n-        ExecuteBashScript("./mount_fsx.sh").run(fsx_dns_name, fsx_mountname, "/fsx")\n+   ExecuteBashScript("./mount_fsx.sh").run("fs-05dac34e835f2c48f.fsx.us-west-2.amazonaws.com", "4owupbev", "/fsx/home")\n+   ExecuteBashScript("./mount_fsx.sh").run("fs-0972ef1ec89bcc14c.fsx.us-west-2.amazonaws.com", "6eoi7bev", "/fsx/mount2")\n+   ExecuteBashScript("./mount_fsx.sh").run("fs-0da5542b6a0808375.fsx.us-west-2.amazonaws.com", "yioi7bev", "/fsx/mount3")\n'})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:["(Optional) If you changed the ",(0,o.jsx)(n.code,{children:"/fsx"})," mount, you'll need to modify ",(0,o.jsx)(n.code,{children:"fsx_ubuntu.sh"})," to move the home directory from ",(0,o.jsx)(n.code,{children:"/home/ubuntu"})," to ",(0,o.jsx)(n.code,{children:"/fsx/home/ubuntu"}),":"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-diff",children:'#!/bin/bash\n\n# move the ubuntu user to the shared /fsx filesystem\n- if [ -d "/fsx/ubuntu" ]; then\n-    sudo usermod -d /fsx/ubuntu ubuntu\n- elif [ -d "/fsx" ]; then\n-    sudo usermod -m -d /fsx/ubuntu ubuntu\n- fi\n+ if [ -d "/fsx/home/ubuntu" ]; then\n+    sudo usermod -d /fsx/home/ubuntu ubuntu\n+ elif [ -d "/fsx/home" ]; then\n+    sudo usermod -m -d /fsx/home/ubuntu ubuntu\n+ fi\n'})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsxs)(n.li,{children:["Next upload these files and create your cluster. You should see the changes reflected in ",(0,o.jsx)(n.code,{children:"df -h"}),". Voila!"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ df -h\n...\n10.1.103.128@tcp:/4owupbev  4.5T   85G  4.4T   2% /fsx/home\n10.1.103.128@tcp:/6eoi7bev  1.2T   85G  1.2T   1% /fsx/mount2\n10.1.103.128@tcp:/yioi7bev  1.2T   85G  1.2T   1% /fsx/mount3\n"})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>u,x:()=>d});var t=s(6540);const o={},i=t.createContext(o);function u(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:u(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);