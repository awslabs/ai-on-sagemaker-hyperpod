"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4677],{2110:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Tips/Slurm/login-node","title":"Login Node","description":"Login nodes allow users to login to the cluster, submit jobs, and view and manipulate data without running on the critical slurmctld scheduler node. This also allows you to run monitoring servers like aim, Tensorboard, or Grafana/Prometheus.","source":"@site/docs/08-Tips/Slurm/07-login-node.md","sourceDirName":"08-Tips/Slurm","slug":"/Tips/Slurm/login-node","permalink":"/docs/Tips/Slurm/login-node","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Login Node","weight":47},"sidebar":"tutorialSidebar","previous":{"title":"Bastion Host","permalink":"/docs/Tips/Slurm/bastion-host"},"next":{"title":"Gres (--gpus)","permalink":"/docs/Tips/Slurm/gres"}}');var r=s(4848),i=s(8453);const t={title:"Login Node",weight:47},l=void 0,a={},c=[{value:"Setup",id:"setup",level:2},{value:"Login",id:"login",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Login nodes allow users to login to the cluster, submit jobs, and view and manipulate data without running on the critical ",(0,r.jsx)(n.code,{children:"slurmctld"})," scheduler node. This also allows you to run monitoring servers like ",(0,r.jsx)(n.a,{href:"https://github.com/aimhubio/aim",children:"aim"}),", ",(0,r.jsx)(n.a,{href:"https://www.tensorflow.org/tensorboard",children:"Tensorboard"}),", or ",(0,r.jsx)(n.a,{href:"https://prometheus.io/docs/visualization/grafana/",children:"Grafana/Prometheus"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"In this guide we'll assume you have a cluster setup already with a FSx Filesystem."}),"\n",(0,r.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["First modify your ",(0,r.jsx)(n.code,{children:"cluster_config.json"})," file and add a section:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "InstanceGroupName": "login-group",\n    "InstanceType": "ml.m5.4xlarge",\n    "InstanceCount": 1,\n    "LifeCycleConfig": {\n        "SourceS3Uri": "s3://${BUCKET}/src",\n        "OnCreate": "on_create.sh"\n    },\n    "ExecutionRole": "${ROLE}",\n    "ThreadsPerCore": 2\n},\n'})}),"\n",(0,r.jsxs)(n.p,{children:["You'll also need to remove the ",(0,r.jsx)(n.code,{children:"VpcConfig"})," section from the ",(0,r.jsx)(n.code,{children:"cluster_config.json"})," file."]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Next update your ",(0,r.jsx)(n.code,{children:"provisioning_parameters.json"})," file to include the line:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'  "login_group": "login-group",\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Upload that to S3:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# copy to the S3 Bucket\naws s3 cp provisioning_parameters.json s3://${BUCKET}/src/\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Verify the ",(0,r.jsx)(n.code,{children:"provisioning_parameters.json"})," were correctly updated. You should see the new parameter ",(0,r.jsx)(n.code,{children:"login_group"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws s3 cp s3://${BUCKET}/src/provisioning_parameters.json -\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Finally update your cluster:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws sagemaker update-cluster  --cli-input-json file://cluster-config.json --region $AWS_REGION\n"})}),"\n",(0,r.jsx)(n.h2,{id:"login",children:"Login"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Using the ",(0,r.jsx)(n.code,{children:"easy-ssh.sh"})," script we'll login to the login node:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./easy-ssh.sh -c login-group ml-cluster\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Change the home directory to ",(0,r.jsx)(n.code,{children:"/fsx/ubuntu"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"usermod -m -d /fsx/ubuntu ubuntu\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var o=s(6540);const r={},i=o.createContext(r);function t(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);