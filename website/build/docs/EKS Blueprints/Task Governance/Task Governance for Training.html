<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-EKS Blueprints/Task Governance/Task Governance for Training" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Task Governance | AI on Sagemaker Hyperpod</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://awslabs.github.io/img/header_background.png"><meta data-rh="true" name="twitter:image" content="https://awslabs.github.io/img/header_background.png"><meta data-rh="true" property="og:url" content="https://awslabs.github.io/docs/EKS Blueprints/Task Governance/Task Governance for Training"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keyworkds" content="machine learning, generative ai, genai, sagemaker, hyperpod, sagemaker hyperpod,         model training, model inference, nemo framework, pytorch, pytorch framework"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Task Governance | AI on Sagemaker Hyperpod"><meta data-rh="true" name="description" content="SageMaker HyperPod task governance is a management system designed to streamline resource allocation and ensure efficient utilization of compute resources across teams and projects for your Amazon EKS clusters. It provides administrators with the capability to set priority levels for various tasks, allocate compute resources for each team, determine how idle compute is borrowed and lent between teams, and configure whether a team can preempt its own tasks."><meta data-rh="true" property="og:description" content="SageMaker HyperPod task governance is a management system designed to streamline resource allocation and ensure efficient utilization of compute resources across teams and projects for your Amazon EKS clusters. It provides administrators with the capability to set priority levels for various tasks, allocate compute resources for each team, determine how idle compute is borrowed and lent between teams, and configure whether a team can preempt its own tasks."><link data-rh="true" rel="icon" href="/img/Amazon-Sagemaker-Icon.jpg"><link data-rh="true" rel="canonical" href="https://awslabs.github.io/docs/EKS Blueprints/Task Governance/Task Governance for Training"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/docs/EKS Blueprints/Task Governance/Task Governance for Training" hreflang="en"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/docs/EKS Blueprints/Task Governance/Task Governance for Training" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"EKS Blueprints","item":"https://awslabs.github.io/docs/category/eks-blueprints"},{"@type":"ListItem","position":2,"name":"Task Governance","item":"https://awslabs.github.io/docs/category/task-governance"},{"@type":"ListItem","position":3,"name":"Task Governance","item":"https://awslabs.github.io/docs/EKS Blueprints/Task Governance/Task Governance for Training"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="AI on Sagemaker Hyperpod RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="AI on Sagemaker Hyperpod Atom Feed"><link rel="stylesheet" href="/assets/css/styles.61e3011e.css">
<script src="/assets/js/runtime~main.90750e31.js" defer="defer"></script>
<script src="/assets/js/main.f3372c9d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/Amazon-Sagemaker-Icon.jpg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Amazon-Sagemaker-Icon.jpg" alt="AI on Sagemaker Hyperpod" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Amazon-Sagemaker-Icon.jpg" alt="AI on Sagemaker Hyperpod" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AI on Sagemaker Hyperpod</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Introduction">Workshop</a><a class="navbar__item navbar__link" href="/resources">Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/awslabs/ai-on-sagemaker-hyperpod" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/eks-blueprints">EKS Blueprints</a><button aria-label="Collapse sidebar category &#x27;EKS Blueprints&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/training">Training</a><button aria-label="Expand sidebar category &#x27;Training&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/fine-tuning">Fine Tuning</a><button aria-label="Expand sidebar category &#x27;Fine Tuning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/inference">Inference</a><button aria-label="Expand sidebar category &#x27;Inference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/resiliency">Resiliency</a><button aria-label="Expand sidebar category &#x27;Resiliency&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/task-governance">Task Governance</a><button aria-label="Collapse sidebar category &#x27;Task Governance&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/EKS Blueprints/Task Governance/Task Governance for Training">Task Governance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/EKS Blueprints/Task Governance/Task Governance for Inference">Task Governance for Inference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/observability">Observability</a><button aria-label="Expand sidebar category &#x27;Observability&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/slurm-blueprints">SLURM Blueprints</a><button aria-label="Expand sidebar category &#x27;SLURM Blueprints&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/dashboards">Dashboards</a><button aria-label="Expand sidebar category &#x27;Dashboards&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tools">Tools</a><button aria-label="Expand sidebar category &#x27;Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/diagrams">Diagrams</a><button aria-label="Expand sidebar category &#x27;Diagrams&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/infrastructure-as-a-code">Infrastructure as a Code</a><button aria-label="Expand sidebar category &#x27;Infrastructure as a Code&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/eks-blueprints"><span>EKS Blueprints</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/task-governance"><span>Task Governance</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Task Governance</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using Task Governance to optimize operation performance</h1></header>
<p>SageMaker HyperPod task governance is a management system designed to streamline resource allocation and ensure efficient utilization of compute resources across teams and projects for your Amazon EKS clusters. It provides administrators with the capability to set priority levels for various tasks, allocate compute resources for each team, determine how idle compute is borrowed and lent between teams, and configure whether a team can preempt its own tasks.</p>
<p>HyperPod task governance leverages Kueue for Kubernetes-native job queueing, scheduling, and quota management and is installed using the HyperPod task governance EKS add-on.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-add-on">Installing the add-on<a href="#installing-the-add-on" class="hash-link" aria-label="Direct link to Installing the add-on" title="Direct link to Installing the add-on">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-task-governance-eks-add-on">Setup Task Governance EKS add-on<a href="#setup-task-governance-eks-add-on" class="hash-link" aria-label="Direct link to Setup Task Governance EKS add-on" title="Direct link to Setup Task Governance EKS add-on">​</a></h3>
<p>To install SageMaker HyperPod task governance, you will need Kubernetes version 1.30 or greater and you will need to remove any existing installations of Kueue.</p>
<div><div><p>Navigate to your HyperPod Cluster in the SageMaker AI console. In the <strong>Dashboard</strong> tab, click <code>Install</code> under the Amazon SageMaker HyperPod task governance add-on.</p><p></p><div>AddOn</div><p></p></div><div><p>To install the <strong>SageMaker HyperPod task governance EKS add-on</strong>, run the following command:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws eks create-addon --region $REGION --cluster-name $EKS_CLUSTER_NAME --addon-name amazon-sagemaker-hyperpod-taskgovernance</span><br></span></code></pre></div></div><p>Verify successful installation with:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws eks describe-addon --region $REGION --cluster-name $EKS_CLUSTER_NAME --addon-name amazon-sagemaker-hyperpod-taskgovernance</span><br></span></code></pre></div></div><p>If the installation was successful, you should see details about the installed add-on in the output.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-governance-concepts">Task governance concepts<a href="#task-governance-concepts" class="hash-link" aria-label="Direct link to Task governance concepts" title="Direct link to Task governance concepts">​</a></h2>
<p>Amazon SageMaker HyperPod task governance uses policies to define resource allocation and task prioritization. These policies are categorized into <strong>compute prioritization</strong> and <strong>compute allocation</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-policy">Cluster policy<a href="#cluster-policy" class="hash-link" aria-label="Direct link to Cluster policy" title="Direct link to Cluster policy">​</a></h3>
<p>Compute prioritization, also known as <strong>cluster policy</strong>, determines how idle compute is borrowed and how tasks are prioritized across teams. A cluster policy consists of two key components:</p>
<ul>
<li>Task Prioritization</li>
<li>Idle Compute Allocation</li>
</ul>
<p></p><div>Cluster-Policy</div><p></p>
<p>As an administrator, you should define your organization&#x27;s priorities and configure the cluster policy accordingly.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="idle-compute-allocation">Idle compute allocation<a href="#idle-compute-allocation" class="hash-link" aria-label="Direct link to Idle compute allocation" title="Direct link to Idle compute allocation">​</a></h4>
<p>Idle compute allocation defines how idle compute are distributed among teams. This determines whether and how teams can borrow idle compute. You can choose between the following allocation strategies:</p>
<ul>
<li><strong>First-come first-serve</strong>: Teams are not prioritized over one another. Each incoming task has an equal chance of obtaining over-quota resources. Compute is allocated based on the order of task submission, meaning a single user could use 100% of the idle compute if they request it first.</li>
<li><strong>Fair-share</strong>: Teams borrow idle compute based on their assigned <strong>Fair-share weight</strong>. These weights are defined in <strong>Compute Allocation</strong> and determine how compute is distributed among teams when idle resources are available.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="task-prioritization">Task prioritization<a href="#task-prioritization" class="hash-link" aria-label="Direct link to Task prioritization" title="Direct link to Task prioritization">​</a></h4>
<p>Task prioritization determines how tasks are queued as compute becomes available. You can choose between the following methods:</p>
<ul>
<li><strong>First-come first-serve</strong>: Tasks are queued in the order they are submitted.</li>
<li><strong>Task ranking</strong>: Tasks are queued based on their assigned priority. Tasks within the same priority class are processed on a first-come, first-serve basis. If <strong>Task Preemption</strong> is enabled in <strong>Compute Allocation</strong>, higher-priority tasks can preempt lower-priority tasks within the same team</li>
</ul>
<p>Here&#x27;s an example configuration for a cluster policy. In this example, we have <code>inference</code> tasks as top priority, and have enabled the idle compute allocation to the fair-share strategy (based on team weights).</p>
<p></p><div>Cluster-Policy-Priorities</div><p></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-allocations">Compute allocations<a href="#compute-allocations" class="hash-link" aria-label="Direct link to Compute allocations" title="Direct link to Compute allocations">​</a></h3>
<p>Compute allocation, or compute quota, defines a team’s compute allocation and what weight (or priority level) a team is given for fair-share idle compute allocation.</p>
<p>You will need at minimum two compute allocations created in order to borrow capacity and preempt tasks across teams. The total reserved quota should not surpass the cluster&#x27;s available capacity for that resource, to ensure proper quota management. For example, if a cluster comprises 20 ml.c5.2xlarge instances, the cumulative quota assigned to teams should remain under 20. For more details on how compute is allocated in task governance, please follow the <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-hyperpod-eks-operate-console-ui-governance.html" target="_blank" rel="noopener noreferrer">documentation for task governance</a>.</p>
<p></p><div>CQ1</div><p></p>
<p>In the next section, we will walk through a detailed example with step-by-step instructions on configuring these settings.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<div><p>This section demonstrates how to configure task governance using an example cluster with 4 <strong>g5.8xlarge</strong> instances. If you haven&#x27;t set up the HyperPod task governance add-on, refer to the <a href="/docs/category/getting-started">Task Governance Setup</a> page.</p></div>
<p>This section will guide you on an end to end example of using task governance. We use a cluster of 4 g5.8xlarge instances split between two teams (Team A and Team B).</p>
<p>Before running the examples, we will set up a Cluster Policy and define Compute Allocations for the teams. The policy will use task ranking instead of the default FIFO (First-In-First-Out) behavior, allowing higher-priority tasks to preempt lower-priority ones.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-cluster-policy">Setup cluster policy<a href="#setup-cluster-policy" class="hash-link" aria-label="Direct link to Setup cluster policy" title="Direct link to Setup cluster policy">​</a></h3>
<p>Setup env variables:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export HYPERPOD_CLUSTER_ARN={your-hyperpod-cluster-arn}</span><br></span></code></pre></div></div>
<p>To update how tasks are prioritized and how idle compute is allocated, apply a Cluster Policy using the following configuration:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws sagemaker \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create-cluster-scheduler-config \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name &quot;example-cluster-scheduler-config&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cluster-arn $HYPERPOD_CLUSTER_ARN \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --scheduler-config &quot;PriorityClasses=[{Name=inference,Weight=90},{Name=experimentation,Weight=80},{Name=fine-tuning,Weight=50},{Name=training,Weight=70}],FairShare=Enabled&quot;</span><br></span></code></pre></div></div>
<p>This CLI command will output two values: CreateSchedulerConfigArn and ClusterSchedulerConfigId. This will generate a cluster policy with fair sharing enabled and the following priority classes:</p>
<p></p><div>Cluster_policy</div><p></p>
<p>A higher weight indicates a higher priority. In this example, the <code>inference</code> priority class has the highest priority.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-compute-allocations">Setup compute allocations<a href="#setup-compute-allocations" class="hash-link" aria-label="Direct link to Setup compute allocations" title="Direct link to Setup compute allocations">​</a></h3>
<p>Each team requires a Compute Allocation to manage their compute capacity. Both teams will have 2 instances allocated, 0 fair-share weight, and 50% borrowing capability.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws sagemaker \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create-compute-quota \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name &quot;Team-A-Quota-Allocation&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cluster-arn $HYPERPOD_CLUSTER_ARN \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --compute-quota-config &quot;ComputeQuotaResources=[{InstanceType=ml.g5.8xlarge,Count=2}],ResourceSharingConfig={Strategy=LendAndBorrow,BorrowLimit=50},PreemptTeamTasks=LowerPriority&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --activation-state &quot;Enabled&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --compute-quota-target &quot;TeamName=team-a,FairShareWeight=0&quot;</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws sagemaker \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create-compute-quota \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name &quot;Team-B-Quota-Allocation&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cluster-arn $HYPERPOD_CLUSTER_ARN \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --compute-quota-config &quot;ComputeQuotaResources=[{InstanceType=ml.g5.8xlarge,Count=2}],ResourceSharingConfig={Strategy=LendAndBorrow,BorrowLimit=50},PreemptTeamTasks=LowerPriority&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --activation-state &quot;Enabled&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --compute-quota-target &quot;TeamName=team-b,FairShareWeight=0&quot;</span><br></span></code></pre></div></div>
<p></p><div>Example</div><p></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="clone-the-examples-repository">Clone the examples repository<a href="#clone-the-examples-repository" class="hash-link" aria-label="Direct link to Clone the examples repository" title="Direct link to Clone the examples repository">​</a></h3>
<p>Navigate to your home directory or your preferred project directory, clone the repo.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/aws-samples/awsome-distributed-training/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd awsome-distributed-training/1.architectures/7.sagemaker-hyperpod-eks/task-governance</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="borrow-compute-from-another-team">Borrow compute from another team<a href="#borrow-compute-from-another-team" class="hash-link" aria-label="Direct link to Borrow compute from another team" title="Direct link to Borrow compute from another team">​</a></h2>
<div><p>This section provides a walkthrough of a job submission using task governance, based on the setup created in the <a href="/docs/category/getting-started">Setup for running the examples</a> page.</p></div>
<p><strong>Scenario:</strong> Team A submits a PyTorch job that requires <strong>3 instances</strong> but only has <strong>2 allocated</strong>. The system allows Team A to <strong>borrow</strong> 1 instance from Team B&#x27;s idle capacity.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f 1-imagenet-gpu-team-a.yaml --namespace hyperpod-ns-team-a</span><br></span></code></pre></div></div>
<p>Verify the job is running (pulling the container image might take a moment):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -n hyperpod-ns-team-a</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                             READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-gpu-679b676b55-5xj5x        1/1     Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imagenet-gpu-team-a-1-worker-0   1/1     Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imagenet-gpu-team-a-1-worker-1   1/1     Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imagenet-gpu-team-a-1-worker-2   1/1     Running   0          5m</span><br></span></code></pre></div></div>
<p>In the task tab of the console, you should see the job running:</p>
<p></p><div>Example</div><p></p>
<p>Once the pods are running, you can check the output of logs to identify the elected master:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs imagenet-gpu-team-a-1-worker-0 --namespace hyperpod-ns-team-a | grep master_addr=</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2025-02-04 18:58:08,460] torch.distributed.elastic.agent.server.api: [INFO]   master_addr=imagenet-gpu-team-a-1-worker-2</span><br></span></code></pre></div></div>
<p>You can then use the pod referenced in the <code>master_addr</code> to look at the current training progress:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs imagenet-gpu-team-a-1-worker-2 --namespace hyperpod-ns-team-a</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reclaim-guaranteed-compute">Reclaim guaranteed compute<a href="#reclaim-guaranteed-compute" class="hash-link" aria-label="Direct link to Reclaim guaranteed compute" title="Direct link to Reclaim guaranteed compute">​</a></h2>
<div><p>This section provides a walkthrough of a job submission using task governance, based on the setup created in the <a href="/docs/category/getting-started">Setup for running the examples</a>. It also demonstrates how to run the sample application using the HyperPod CLI instead of kubectl. If you haven&#x27;t installed the HyperPod CLI, refer to the <a href="/docs/category/getting-started">Install HyperPod CLI</a> page.</p></div>
<p><strong>Scenario:</strong> Team B needs to reclaim its compute resources. By submitting a job requiring <strong>2 instances</strong>, Team B&#x27;s job is <strong>prioritized</strong>, and Job 1 is <strong>suspended</strong> due to resource unavailability.</p>
<p>In this example, we&#x27;ll be using the hyperpod CLI, but we could also use kubectl and have identical behavior.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hyperpod start-job --config-file 2-hyperpod-cli-example-team-b.yaml</span><br></span></code></pre></div></div>
<p>This command will give you a similar output:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &quot;Console URL&quot;: &quot;https://us-east-1.console.aws.amazon.com/sagemaker/home?region=us-east-1#/cluster-management/ml-cluster&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>After the job has been submitted, you can see that the workers from Job 1 have been preempted, and only the workers in Team B&#x27;s namespace are running.</p>
<p></p><div>Example</div><p></p>
<p>Check running pods for Team B:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -n hyperpod-ns-team-b</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                 READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hyperpod-cli-mnist-team-b-worker-0   1/1     Running   0          3m47s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hyperpod-cli-mnist-team-b-worker-1   1/1     Running   0          3m47s</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preempt-low-priority-tasks">Preempt low priority tasks<a href="#preempt-low-priority-tasks" class="hash-link" aria-label="Direct link to Preempt low priority tasks" title="Direct link to Preempt low priority tasks">​</a></h2>
<div><p>This section provides a walkthrough of a job submission using task governance, based on the setup created in the <a href="/docs/category/getting-started">Setup for running the examples</a> page.</p></div>
<p><strong>Scenario:</strong> Team B submits a <strong>high-priority job</strong> requiring <strong>2 instances</strong>. Since high-priority jobs take precedence, <strong>Job 2 is suspended</strong>, ensuring Team B’s critical workload runs first.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f 3-imagenet-gpu-team-b-higher-prio.yaml --namespace hyperpod-ns-team-b</span><br></span></code></pre></div></div>
<p>Since this job uses a <strong>priority-class</strong> with a higher weight than the other jobs, the lower-priority Job 2 is preempted:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -n hyperpod-ns-team-b</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                 READY   STATUS        RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-gpu-6584d647d4-5z564            1/1     Running       0          11s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hyperpod-cli-mnist-team-b-worker-0   1/1     Terminating   0          28s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hyperpod-cli-mnist-team-b-worker-1   1/1     Terminating   0          28s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imagenet-gpu-team-b-2-worker-0       1/1     Running       0          10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imagenet-gpu-team-b-2-worker-1       1/1     Running       0          10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p></p><div>Example</div><p></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-workloads">Inspecting workloads<a href="#inspecting-workloads" class="hash-link" aria-label="Direct link to Inspecting workloads" title="Direct link to Inspecting workloads">​</a></h3>
<p>We can also inspect the workloads on a particular namespace:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get workloads -n hyperpod-ns-team-b</span><br></span></code></pre></div></div>
<p>This is an example output of the command after running all 3 scenarios:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                         QUEUE                           RESERVED IN                       ADMITTED   FINISHED   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod-etcd-gpu-6584d647d4-sp6xx-bb3f9          hyperpod-ns-team-b-localqueue   hyperpod-ns-team-b-clusterqueue   True                  11s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pytorchjob-hyperpod-cli-mnist-team-b-2c720   hyperpod-ns-team-b-localqueue                                     False                 45s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pytorchjob-imagenet-gpu-team-b-2-ef5c0       hyperpod-ns-team-b-localqueue   hyperpod-ns-team-b-clusterqueue   True                  11s</span><br></span></code></pre></div></div>
<p>We can see that the workload for Job 2 has been set to <code>ADMITTED: False</code> because the newly submitted workload took precedence.</p>
<p>When we describe the suspended workload, we can see the reason it was preempted.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe workload pytorchjob-hyperpod-cli-mnist-team-b-2c720 -n hyperpod-ns-team-b</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-02-04T19:06:25Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               couldn&#x27;t assign flavors to pod set worker: borrowing limit for nvidia.com/gpu in flavor ml.g5.8xlarge exceeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Observed Generation:   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                Pending</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  QuotaReserved</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-02-04T19:06:25Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               Preempted to accommodate a workload (UID: d34468c2-1ce5-47cd-a61d-689be78b6121) due to prioritization in the ClusterQueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Observed Generation:   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                Preempted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  Evicted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-02-04T19:06:25Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               The workload has no reservation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Observed Generation:   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                NoReservation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  Admitted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-02-04T19:06:25Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               Preempted to accommodate a workload (UID: d34468c2-1ce5-47cd-a61d-689be78b6121) due to prioritization in the ClusterQueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                InClusterQueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  Preempted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-02-04T19:06:25Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               Preempted to accommodate a workload (UID: d34468c2-1ce5-47cd-a61d-689be78b6121) due to prioritization in the ClusterQueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Observed Generation:   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                Preempted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  Requeued</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/task-governance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Task Governance</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/EKS Blueprints/Task Governance/Task Governance for Inference"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Task Governance for Inference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installing-the-add-on" class="table-of-contents__link toc-highlight">Installing the add-on</a><ul><li><a href="#setup-task-governance-eks-add-on" class="table-of-contents__link toc-highlight">Setup Task Governance EKS add-on</a></li></ul></li><li><a href="#task-governance-concepts" class="table-of-contents__link toc-highlight">Task governance concepts</a><ul><li><a href="#cluster-policy" class="table-of-contents__link toc-highlight">Cluster policy</a></li><li><a href="#compute-allocations" class="table-of-contents__link toc-highlight">Compute allocations</a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#setup-cluster-policy" class="table-of-contents__link toc-highlight">Setup cluster policy</a></li><li><a href="#setup-compute-allocations" class="table-of-contents__link toc-highlight">Setup compute allocations</a></li><li><a href="#clone-the-examples-repository" class="table-of-contents__link toc-highlight">Clone the examples repository</a></li></ul></li><li><a href="#borrow-compute-from-another-team" class="table-of-contents__link toc-highlight">Borrow compute from another team</a></li><li><a href="#reclaim-guaranteed-compute" class="table-of-contents__link toc-highlight">Reclaim guaranteed compute</a></li><li><a href="#preempt-low-priority-tasks" class="table-of-contents__link toc-highlight">Preempt low priority tasks</a><ul><li><a href="#inspecting-workloads" class="table-of-contents__link toc-highlight">Inspecting workloads</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/Introduction">Workshop</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/aws-samples/awsome-distributed-training" target="_blank" rel="noopener noreferrer" class="footer__link-item">Awsome Distributed Training<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://aws.amazon.com/sagemaker/ai/hyperpod" target="_blank" rel="noopener noreferrer" class="footer__link-item">Amazon Sagemaker Hyperpod<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://repost.aws" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS re:Post<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://aws.training" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS Training &amp; Certification<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/awslabs/ai-on-sagemaker-hyperpod" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWSome Distributed Training repository<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 ML Frameworks. Built with ❤️ at AWS.</div></div></div></footer></div>
</body>
</html>