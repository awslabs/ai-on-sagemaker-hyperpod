<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-getting-started/orchestrated-by-eks/Set up your shared file system" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Set up your shared file system | AI on SageMaker HyperPod</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://awslabs.github.io/ai-on-sagemaker-hyperpod/img/header_background.png"><meta data-rh="true" name="twitter:image" content="https://awslabs.github.io/ai-on-sagemaker-hyperpod/img/header_background.png"><meta data-rh="true" property="og:url" content="https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="machine learning, generative ai, genai, sagemaker, hyperpod, SageMaker HyperPod,         model training, model inference, nemo framework, pytorch, pytorch framework"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Set up your shared file system | AI on SageMaker HyperPod"><meta data-rh="true" name="description" content="Why Shared File Systems Matter"><meta data-rh="true" property="og:description" content="Why Shared File Systems Matter"><link data-rh="true" rel="icon" href="/ai-on-sagemaker-hyperpod/img/Amazon-Sagemaker-Icon.jpg"><link data-rh="true" rel="canonical" href="https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system" hreflang="en"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Getting Started","item":"https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/category/getting-started"},{"@type":"ListItem","position":2,"name":"Orchestrated by EKS","item":"https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/"},{"@type":"ListItem","position":3,"name":"Set up your shared file system","item":"https://awslabs.github.io/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system"}]}</script><link rel="alternate" type="application/rss+xml" href="/ai-on-sagemaker-hyperpod/blog/rss.xml" title="AI on SageMaker HyperPod RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ai-on-sagemaker-hyperpod/blog/atom.xml" title="AI on SageMaker HyperPod Atom Feed"><link rel="stylesheet" href="/ai-on-sagemaker-hyperpod/assets/css/styles.4f331a72.css">
<script src="/ai-on-sagemaker-hyperpod/assets/js/runtime~main.0ad2ba88.js" defer="defer"></script>
<script src="/ai-on-sagemaker-hyperpod/assets/js/main.31186e7d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ai-on-sagemaker-hyperpod/img/Amazon-Sagemaker-Icon.jpg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai-on-sagemaker-hyperpod/"><div class="navbar__logo"><img src="/ai-on-sagemaker-hyperpod/img/Amazon-Sagemaker-Icon.jpg" alt="AI on SageMaker HyperPod" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ai-on-sagemaker-hyperpod/img/Amazon-Sagemaker-Icon.jpg" alt="AI on SageMaker HyperPod" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AI on SageMaker HyperPod</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Orchestrated by EKS</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/initial-cluster-setup">Initial cluster setup</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/eks-blueprints/training/trainium/aws-trainium">AWS Trainium</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/eks-blueprints/training/ddp/distributed-data-parallel">Distributed Data Parallel</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/eks-blueprints/training/fsdp/fully-sharded-data-parallel">Fully Sharded Data Parallel</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/eks-blueprints/training/megatron-lm/megatron-lm-readme">NVIDIA Megatron LM</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/eks-blueprints/training/ray-train/ray-train-readme">Ray Train</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Orchestrated by SLURM</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm/initial-cluster-setup">Initial cluster setup</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/slurm-blueprints/training/trainium/Llama3-70B">AWS Trainium</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/slurm-blueprints/training/ddp/distributed-data-parallel">Distributed Data Parallel</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/slurm-blueprints/training/fsdp/fully-sharded-data-parallel">Fully Sharded Data Parallel</a></li><li><a class="dropdown__link" href="/ai-on-sagemaker-hyperpod/docs/slurm-blueprints/training/megatron-lm/megatron-lm-readme">NVIDIA Megatron LM</a></li></ul></div><a class="navbar__item navbar__link" href="/ai-on-sagemaker-hyperpod/resources">Useful links</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/awslabs/ai-on-sagemaker-hyperpod" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-on-sagemaker-hyperpod/docs/Introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/ai-on-sagemaker-hyperpod/docs/category/getting-started">Getting Started</a><button aria-label="Collapse sidebar category &#x27;Getting Started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks">Orchestrated by EKS</a><button aria-label="Collapse sidebar category &#x27;Orchestrated by EKS&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/initial-cluster-setup">Creating your SageMaker HyperPod cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Reviewing the cluster console">Reviewing the cluster console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/sagemaker-studio-integration">SageMaker Studio Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Verifying cluster connection to EKS">Verifying cluster connection to EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/additional-information">Additional Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up your shared file system">Set up your shared file system</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Adding a Data Repository Assocation">Adding a Data Repository Association</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Set up an Amazon S3 mountpoint">Set up an Amazon S3 mountpoint</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm">Orchestrated by SLURM</a><button aria-label="Expand sidebar category &#x27;Orchestrated by SLURM&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-on-sagemaker-hyperpod/docs/getting-started/install-pre-requisites">Installing the required tools</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/eks-blueprints">EKS Blueprints</a><button aria-label="Expand sidebar category &#x27;EKS Blueprints&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/slurm-blueprints">SLURM Blueprints</a><button aria-label="Expand sidebar category &#x27;SLURM Blueprints&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/sagemaker-hyperpod-recipes">Sagemaker Hyperpod Recipes</a><button aria-label="Expand sidebar category &#x27;Sagemaker Hyperpod Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/add-ons">Add-Ons</a><button aria-label="Expand sidebar category &#x27;Add-Ons&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/validation-and-testing">Validation and Testing</a><button aria-label="Expand sidebar category &#x27;Validation and Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/infrastructure-as-a-code">Infrastructure as a Code</a><button aria-label="Expand sidebar category &#x27;Infrastructure as a Code&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ai-on-sagemaker-hyperpod/docs/category/tips">Tips</a><button aria-label="Expand sidebar category &#x27;Tips&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ai-on-sagemaker-hyperpod/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ai-on-sagemaker-hyperpod/docs/category/getting-started"><span>Getting Started</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks"><span>Orchestrated by EKS</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Set up your shared file system</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Shared File System Setup for SageMaker HyperPod (EKS)</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-shared-file-systems-matter">Why Shared File Systems Matter<a href="#why-shared-file-systems-matter" class="hash-link" aria-label="Direct link to Why Shared File Systems Matter" title="Direct link to Why Shared File Systems Matter">​</a></h2>
<p>A high-performance shared file system is <strong>critical</strong> for achieving optimal performance in distributed machine learning workloads on SageMaker HyperPod. Without proper shared storage, your training jobs will be severely bottlenecked by data I/O operations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-impact">Performance Impact<a href="#performance-impact" class="hash-link" aria-label="Direct link to Performance Impact" title="Direct link to Performance Impact">​</a></h3>
<ul>
<li><strong>Data Loading Bottlenecks</strong>: Without shared storage, each pod must independently load training data, creating massive I/O overhead</li>
<li><strong>Checkpoint Synchronization</strong>: Model checkpoints and intermediate results need fast, consistent access across all pods</li>
<li><strong>Memory Efficiency</strong>: Shared file systems enable efficient data caching and reduce memory pressure on individual pods</li>
<li><strong>Scaling Limitations</strong>: Local storage approaches fail to scale beyond single-pod training</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fsx-for-lustre-benefits">FSx for Lustre Benefits<a href="#fsx-for-lustre-benefits" class="hash-link" aria-label="Direct link to FSx for Lustre Benefits" title="Direct link to FSx for Lustre Benefits">​</a></h3>
<p>Amazon FSx for Lustre is specifically designed for high-performance computing workloads and provides:</p>
<ul>
<li><strong>High Throughput</strong>: Up to hundreds of GB/s of aggregate throughput</li>
<li><strong>Low Latency</strong>: Sub-millisecond latencies for small file operations</li>
<li><strong>POSIX Compliance</strong>: Standard file system semantics that work with existing ML frameworks</li>
<li><strong>S3 Integration</strong>: Seamless data repository associations with Amazon S3</li>
<li><strong>Elastic Scaling</strong>: Storage capacity that can grow with your workload demands</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-options">Setup Options<a href="#setup-options" class="hash-link" aria-label="Direct link to Setup Options" title="Direct link to Setup Options">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-1-auto-provisioned-console-quick-setup">Option 1: Auto-Provisioned (Console Quick Setup)<a href="#option-1-auto-provisioned-console-quick-setup" class="hash-link" aria-label="Direct link to Option 1: Auto-Provisioned (Console Quick Setup)" title="Direct link to Option 1: Auto-Provisioned (Console Quick Setup)">​</a></h3>
<p>When you create a HyperPod cluster through the AWS Console using the <strong>Quick Setup</strong> path, FSx for Lustre is automatically provisioned and configured for you.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-gets-created-automatically">What Gets Created Automatically<a href="#what-gets-created-automatically" class="hash-link" aria-label="Direct link to What Gets Created Automatically" title="Direct link to What Gets Created Automatically">​</a></h4>
<p>The console automatically provisions:</p>
<ul>
<li><strong>FSx for Lustre file system</strong> with optimal performance settings</li>
<li><strong>Proper networking configuration</strong> in the same VPC and subnet as your cluster</li>
<li><strong>Security group rules</strong> allowing NFS traffic between cluster nodes and FSx</li>
<li><strong>FSx CSI driver installation</strong> for Kubernetes integration</li>
<li><strong>Storage classes and persistent volumes</strong> ready for use in pods</li>
<li><strong>IAM permissions</strong> for the cluster to access the file system</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="verification-steps">Verification Steps<a href="#verification-steps" class="hash-link" aria-label="Direct link to Verification Steps" title="Direct link to Verification Steps">​</a></h4>
<p>After your cluster reaches <code>InService</code> status, verify FSx is properly configured:</p>
<ol>
<li>
<p><strong>Check FSx CSI driver installation</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> kube-system </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> app.kubernetes.io/name</span><span class="token operator">=</span><span class="token plain">aws-fsx-csi-driver</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Verify storage class</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get storageclass </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> fsx</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Test with a sample pod</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token string bash punctuation" style="color:rgb(248, 248, 242)"> </span><span class="token string bash punctuation operator" style="color:rgb(248, 248, 242)">|</span><span class="token string bash punctuation" style="color:rgb(248, 248, 242)"> kubectl apply </span><span class="token string bash punctuation parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token string bash punctuation" style="color:rgb(248, 248, 242)"> -</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">apiVersion: v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">kind: Pod</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  name: fsx-test</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  containers:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  - name: test</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    image: ubuntu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo &#x27;Hello FSx&#x27; &gt; /data/test.txt &amp;&amp; cat /data/test.txt &amp;&amp; sleep 3600&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    volumeMounts:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    - name: fsx-storage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">      mountPath: /data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  volumes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  - name: fsx-storage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    persistentVolumeClaim:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">      claimName: fsx-claim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-2-manual-setup-dynamic-provisioning">Option 2: Manual Setup (Dynamic Provisioning)<a href="#option-2-manual-setup-dynamic-provisioning" class="hash-link" aria-label="Direct link to Option 2: Manual Setup (Dynamic Provisioning)" title="Direct link to Option 2: Manual Setup (Dynamic Provisioning)">​</a></h3>
<p>If you&#x27;re creating your HyperPod cluster via CLI/SDK or want more control over your FSx configuration, you can manually set up dynamic provisioning.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-manual-setup">When to Use Manual Setup<a href="#when-to-use-manual-setup" class="hash-link" aria-label="Direct link to When to Use Manual Setup" title="Direct link to When to Use Manual Setup">​</a></h4>
<ul>
<li><strong>Custom performance requirements</strong>: Need specific throughput or storage configurations</li>
<li><strong>Advanced networking</strong>: Require custom VPC or subnet configurations</li>
<li><strong>Cost optimization</strong>: Need precise control over storage capacity and performance tiers</li>
<li><strong>Integration requirements</strong>: Want to integrate with existing Kubernetes storage workflows</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-amazon-fsx-for-lustre-csi-driver">Install the Amazon FSx for Lustre CSI Driver<a href="#install-the-amazon-fsx-for-lustre-csi-driver" class="hash-link" aria-label="Direct link to Install the Amazon FSx for Lustre CSI Driver" title="Direct link to Install the Amazon FSx for Lustre CSI Driver">​</a></h4>
<p>The <a href="https://github.com/kubernetes-sigs/aws-fsx-csi-driver" target="_blank" rel="noopener noreferrer">Amazon FSx for Lustre Container Storage Interface (CSI) driver</a> uses <a href="https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html" target="_blank" rel="noopener noreferrer">IAM roles for service accounts (IRSA)</a> to authenticate AWS API calls.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Performance Best Practice</div><div class="admonitionContent_BuS1"><p>Make sure that your file system is located in the same Region and Availability Zone as your compute nodes. Accessing a file system in a different Region or Availability Zone will result in reduced I/O performance and increased network costs.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-setup">Step-by-Step Setup<a href="#step-by-step-setup" class="hash-link" aria-label="Direct link to Step-by-Step Setup" title="Direct link to Step-by-Step Setup">​</a></h4>
<ol>
<li>
<p><strong>Create an IAM OIDC identity provider</strong> for your cluster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">eksctl utils associate-iam-oidc-provider </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--cluster</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$EKS_CLUSTER_NAME</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--approve</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Create a service account</strong> with an IAM role for the FSx CSI driver:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">eksctl create iamserviceaccount </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> fsx-csi-controller-sa </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--namespace</span><span class="token plain"> kube-system </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--cluster</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$EKS_CLUSTER_NAME</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --attach-policy-arn arn:aws:iam::aws:policy/AmazonFSxFullAccess </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--approve</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --role-name FSXLCSI-</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${EKS_CLUSTER_NAME}</span><span class="token plain">-</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${AWS_REGION}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--region</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$AWS_REGION</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Verify the service account</strong> annotation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get sa fsx-csi-controller-sa </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> kube-system </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-oyaml</span><span class="token plain"> </span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Deploy the FSx CSI driver</strong> using Helm:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">helm repo </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> aws-fsx-csi-driver https://kubernetes-sigs.github.io/aws-fsx-csi-driver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">helm upgrade </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--install</span><span class="token plain"> aws-fsx-csi-driver aws-fsx-csi-driver/aws-fsx-csi-driver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--namespace</span><span class="token plain"> kube-system </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--set</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">controller.serviceAccount.create</span><span class="token operator">=</span><span class="token plain">false</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Verify CSI driver installation</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> kube-system </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> app.kubernetes.io/name</span><span class="token operator">=</span><span class="token plain">aws-fsx-csi-driver</span><br></span></code></pre></div></div>
</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The [Amazon FSx for Lustre CSI driver](https://github.com/kubernetes-sigs/aws-fsx-csi-driver) presents you with two options for provisioning a file system: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#### Create Dynamic Provisioning Resources</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dynamic provisioning leverages Persistent Volume Claims (PVCs) in Kubernetes. You define a PVC with desired storage specifications, and the CSI Driver automatically provisions the FSx file system based on the PVC request.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1. **Create a storage class** that leverages the `fsx.csi.aws.com` provisioner: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">```bash </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat &lt;&lt;EOF&gt; storageclass.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kind: StorageClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: storage.k8s.io/v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name: fsx-sc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">provisioner: fsx.csi.aws.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parameters:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  subnetId: $PRIVATE_SUBNET_ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  securityGroupIds: $SECURITY_GROUP_ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deploymentType: PERSISTENT_2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  automaticBackupRetentionDays: &quot;0&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  copyTagsToBackups: &quot;true&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  perUnitStorageThroughput: &quot;250&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  dataCompressionType: &quot;LZ4&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fileSystemTypeVersion: &quot;2.15&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mountOptions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - flock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> storageclass.yaml</span><br></span></code></pre></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Parameter Explanation</summary><div><div class="collapsibleContent_i85q"><ul>
<li>
<p><strong>privateSubnetId</strong> - The subnet ID that the FSx for Lustre filesystem should be created inside. Using the <code>$PRIVATE_SUBNET_ID</code> environment variable, we are referencing the same private subnet that was used for HyperPod cluster creation.</p>
</li>
<li>
<p><strong>securityGroupIds</strong> - A list of security group IDs that should be attached to the filesystem. Using the <code>$SECURITY_GROUP</code> environment variable, we are referencing the same security group that was use for HyperPod cluster creation.</p>
</li>
<li>
<p><strong>deploymentType</strong>: <code>PERSISTENT_2</code> is the latest generation of Persistent deployment type, and is best-suited for use cases that require longer-term storage, and have latency-sensitive workloads that require the highest levels of IOPS and throughput. For more information see <a href="https://docs.aws.amazon.com/fsx/latest/LustreGuide/using-fsx-lustre.html" target="_blank" rel="noopener noreferrer">Deployment options for FSx for Lustre file systems</a>.</p>
</li>
<li>
<p><strong>automaticBackupRetentionDays</strong>: The number of days to retain automatic backups. Setting this value to 0 disables the creation of automatic backups. If you set this parameter to a non-zero value, you can also specify the preferred time to take daily backups using the dailyAutomaticBackupStartTime parameter.</p>
</li>
<li>
<p><strong>copyTagsToBackups</strong>: If this value is true, all tags for the file system are copied to all automatic and user-initiated backups.</p>
</li>
<li>
<p><strong>perUnitStorageThroughput</strong>: For <code>PERSISTENT_2</code> deployments, you can specify the storage throughput in MBps per TiB of storage capacity.</p>
</li>
<li>
<p><strong>dataCompressionType</strong>: FSx for Lustre supports data compression via the LZ4 algorithm, which is optimized to deliver high levels of compression without adversely impacting file system performance. For more information see <a href="https://docs.aws.amazon.com/fsx/latest/LustreGuide/data-compression.html" target="_blank" rel="noopener noreferrer">Lustre data compression</a>.</p>
</li>
<li>
<p><strong>fileSystemTypeVersion</strong>: This sets the Lustre version for the FSx for Lustre file system that will be created.</p>
</li>
<li>
<p><strong>mountOptions</strong>: A list of mount options for the file system. The <code>flock</code> option mounts your file system with file lock enabled.</p>
</li>
</ul><p>You can find more information about storage class parameters in the <a href="https://github.com/kubernetes-sigs/aws-fsx-csi-driver/tree/master/examples/kubernetes/dynamic_provisioning#dynamic-provisioning-example" target="_blank" rel="noopener noreferrer">aws-fsx-csi-driver GitHub repository</a></p></div></div></details>
<ol start="2">
<li>
<p><strong>Verify the storage class</strong> was created:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get sc fsx-sc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-oyaml</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Create a persistent volume claim (PVC)</strong>:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain">EOF</span><span class="token operator">&gt;</span><span class="token plain"> pvc.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kind: PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name: fsx-claim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  accessModes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - ReadWriteMany</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  storageClassName: fsx-sc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  resources:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    requests:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      storage: 1200Gi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>PVCs are namespaced Kubernetes resources, so be sure to change the namespace as needed before creation.</p></div></div>
<ol start="4">
<li>
<p><strong>Apply the PVC</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> pvc.yaml</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Monitor PVC status</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get pvc fsx-claim </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> default </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-w</span><br></span></code></pre></div></div>
<p>Wait for the status to change from <code>Pending</code> to <code>Bound</code> (~10 minutes while FSx is provisioned).</p>
</li>
<li>
<p><strong>Retrieve the FSx volume ID</strong> (optional):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get </span><span class="token function" style="color:rgb(80, 250, 123)">pv</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">kubectl get pvc fsx-claim </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> default </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-ojson</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> jq </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> .spec.volumeName</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-ojson</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> jq </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> .spec.csi.volumeHandle</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-3-bring-your-own-fsx-static-provisioning">Option 3: Bring Your Own FSx (Static Provisioning)<a href="#option-3-bring-your-own-fsx-static-provisioning" class="hash-link" aria-label="Direct link to Option 3: Bring Your Own FSx (Static Provisioning)" title="Direct link to Option 3: Bring Your Own FSx (Static Provisioning)">​</a></h3>
<p>If you have an existing FSx for Lustre file system, you can integrate it with your HyperPod cluster using static provisioning.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="requirements-and-considerations">Requirements and Considerations<a href="#requirements-and-considerations" class="hash-link" aria-label="Direct link to Requirements and Considerations" title="Direct link to Requirements and Considerations">​</a></h4>
<p><strong>Network Requirements:</strong></p>
<ul>
<li>FSx file system must be in the <strong>same VPC</strong> as your HyperPod cluster</li>
<li>FSx file system must be in the <strong>same Availability Zone</strong> as your cluster nodes</li>
<li>Security groups must allow NFS traffic between cluster and FSx</li>
</ul>
<p><strong>Performance Considerations:</strong></p>
<ul>
<li>Ensure FSx performance tier matches your workload requirements</li>
<li>Consider data locality - accessing FSx from different AZs reduces performance</li>
<li>Verify sufficient throughput capacity for your cluster size</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="integration-steps">Integration Steps<a href="#integration-steps" class="hash-link" aria-label="Direct link to Integration Steps" title="Direct link to Integration Steps">​</a></h4>
<blockquote>
<p><strong>Note:</strong>
Before using an existing file system with the CSI driver on your EKS HyperPod cluster, please ensure that your FSx file system is in the same subnet (and thus, same Availability Zone) as your HyperPod cluster nodes.</p>
<p>You can check the subnet of your HyperPod nodes by checking the <code>$PRIVATE_SUBNET_ID</code> environment variable set as part of this cluster creation process.</p>
<p>To check the subnet ID of your existing file system, run</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Replace fs-xxx with your file system id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems --file-system-id fs-xxx </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;FileSystems[0].SubnetIds[]&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--output</span><span class="token plain"> text</span><br></span></code></pre></div></div>
</blockquote>
<blockquote>
<p><strong>Note:</strong>
The following YAMLs require variables that are not in our env_vars. To retrieve the variables, you can find them in your AWS console in <code>FSx for Lustre</code> page, or you can run these commands:</p>
<p>FSx For Lustre ID:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--region</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$AWS_REGION</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> jq </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.FileSystems[0].FileSystemId&#x27;</span><br></span></code></pre></div></div>
<p>FSx DNS Name:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--region</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$AWS_REGION</span><span class="token plain"> --file-system-id </span><span class="token operator">&lt;</span><span class="token plain">fs-xxxx</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;FileSystems[0].DNSName&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--output</span><span class="token plain"> text</span><br></span></code></pre></div></div>
<p>FSx Mount Name:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--region</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$AWS_REGION</span><span class="token plain"> --file-system-id </span><span class="token operator">&lt;</span><span class="token plain">fs-xxxx</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;FileSystems[0].LustreConfiguration.MountName&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--output</span><span class="token plain"> text</span><br></span></code></pre></div></div>
</blockquote>
<ol>
<li>
<p><strong>Verify network compatibility</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Check your cluster&#x27;s subnet and AZ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws eks describe-cluster </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$EKS_CLUSTER_NAME</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cluster.resourcesVpcConfig.subnetIds&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check your FSx file system&#x27;s subnet and AZ  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems --file-system-ids </span><span class="token operator">&lt;</span><span class="token plain">your-fsx-id</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;FileSystems[0].SubnetIds&#x27;</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Get FSx file system details</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Get FSx ID, DNS name, and mount name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">FSX_ID</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;fs-xxxxx&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace with your FSx ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems --file-system-ids </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$FSX_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--query</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;FileSystems[0].[FileSystemId,DNSName,LustreConfiguration.MountName]&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--output</span><span class="token plain"> table</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Create a StorageClass</strong> for your existing FSx:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain">EOF</span><span class="token operator">&gt;</span><span class="token plain"> storageclass.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: storage.k8s.io/v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kind: StorageClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name: fsx-sc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">provisioner: fsx.csi.aws.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parameters:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fileSystemId: </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$FSX_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  subnetId: </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$PRIVATE_SUBNET_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  securityGroupIds: </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$SECURITY_GROUP_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> storageclass.yaml</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Create a PersistentVolume (PV)</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain">EOF</span><span class="token operator">&gt;</span><span class="token plain"> pv.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kind: PersistentVolume</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name: fsx-pv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  capacity:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    storage: 1200Gi  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Adjust based on your FSx volume size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  volumeMode: Filesystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  accessModes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - ReadWriteMany</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  persistentVolumeReclaimPolicy: Retain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  storageClassName: fsx-sc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  csi:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    driver: fsx.csi.aws.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    volumeHandle: </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$FSX_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    volumeAttributes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      dnsname: </span><span class="token operator">&lt;</span><span class="token plain">fsx-dns-name</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace with your FSx DNS name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      mountname: </span><span class="token operator">&lt;</span><span class="token plain">fsx-mount-name</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace with your FSx mount name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> pv.yaml</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Create a PersistentVolumeClaim (PVC)</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain">EOF</span><span class="token operator">&gt;</span><span class="token plain"> pvc.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kind: PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  name: fsx-claim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  accessModes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - ReadWriteMany</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  storageClassName: fsx-sc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  resources:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    requests:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      storage: 1200Gi  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Should match the PV size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> pvc.yaml</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-fsx-in-eks-jobs">Using FSx in EKS Jobs<a href="#using-fsx-in-eks-jobs" class="hash-link" aria-label="Direct link to Using FSx in EKS Jobs" title="Direct link to Using FSx in EKS Jobs">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mount-points-and-paths">Mount Points and Paths<a href="#mount-points-and-paths" class="hash-link" aria-label="Direct link to Mount Points and Paths" title="Direct link to Mount Points and Paths">​</a></h3>
<p>FSx for Lustre is accessed through Kubernetes Persistent Volume Claims (PVCs) and can be mounted at any path within your pods. The common pattern is to mount FSx volumes at <code>/data</code>, <code>/fsx</code>, or application-specific paths.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-data-access">Best Practices for Data Access<a href="#best-practices-for-data-access" class="hash-link" aria-label="Direct link to Best Practices for Data Access" title="Direct link to Best Practices for Data Access">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-organization">Data Organization<a href="#data-organization" class="hash-link" aria-label="Direct link to Data Organization" title="Direct link to Data Organization">​</a></h4>
<p>Organize your FSx data structure for optimal access patterns:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Recommended FSx directory structure when mounted in pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/data/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── datasets/           </span><span class="token comment" style="color:rgb(98, 114, 164)"># Training datasets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── checkpoints/        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Model checkpoints  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── outputs/           </span><span class="token comment" style="color:rgb(98, 114, 164)"># Training outputs and logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── code/              </span><span class="token comment" style="color:rgb(98, 114, 164)"># Shared training scripts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">└── scratch/           </span><span class="token comment" style="color:rgb(98, 114, 164)"># Temporary files</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-optimization">Performance Optimization<a href="#performance-optimization" class="hash-link" aria-label="Direct link to Performance Optimization" title="Direct link to Performance Optimization">​</a></h4>
<ol>
<li>
<p><strong>Use ReadWriteMany access mode</strong> for shared access across multiple pods:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">accessModes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> ReadWriteMany</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Leverage data caching</strong> by pre-loading datasets:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Pre-load datasets to FSx before training</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl run data-loader </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--image</span><span class="token operator">=</span><span class="token plain">amazon/aws-cli </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--command</span><span class="token plain"> -- aws s3 </span><span class="token function" style="color:rgb(80, 250, 123)">sync</span><span class="token plain"> s3://your-bucket/dataset /data/datasets</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Optimize checkpoint frequency</strong> to balance performance with fault tolerance:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Save checkpoints to FSx, not local storage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">save</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">state_dict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/data/checkpoints/model_epoch_{}.pth&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">epoch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-management">Data Management<a href="#data-management" class="hash-link" aria-label="Direct link to Data Management" title="Direct link to Data Management">​</a></h4>
<ol>
<li>
<p><strong>Link FSx to S3</strong> for data persistence:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create data repository association</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx create-data-repository-association </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --file-system-id </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$FSX_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --file-system-path /datasets </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --data-repository-path s3://your-bucket/datasets</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Use init containers</strong> for data preparation:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">initContainers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">prep</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> amazon/aws</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cli</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;aws&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s3&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sync&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s3://bucket/data&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/data&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">volumeMounts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fsx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">storage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /data</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues">Common Issues<a href="#common-issues" class="hash-link" aria-label="Direct link to Common Issues" title="Direct link to Common Issues">​</a></h3>
<p><strong>PVC stuck in Pending state</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Check PVC events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl describe pvc fsx-claim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check storage class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get storageclass fsx-sc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify CSI driver pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> kube-system </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> app.kubernetes.io/name</span><span class="token operator">=</span><span class="token plain">aws-fsx-csi-driver</span><br></span></code></pre></div></div>
<p><strong>Pod mount failures</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Check pod events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl describe pod </span><span class="token operator">&lt;</span><span class="token plain">pod-name</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify PVC is bound</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl get pvc fsx-claim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check FSx file system status</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws fsx describe-file-systems --file-system-ids </span><span class="token operator">&lt;</span><span class="token plain">fsx-id</span><span class="token operator">&gt;</span><br></span></code></pre></div></div>
<p><strong>Performance issues</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Monitor FSx metrics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws cloudwatch get-metric-statistics </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--namespace</span><span class="token plain"> AWS/FSx </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --metric-name TotalIOTime </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--dimensions</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">Name</span><span class="token operator">=</span><span class="token plain">FileSystemId,Value</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$FSX_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --start-time </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;1 hour ago&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%S</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --end-time </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%S</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--period</span><span class="token plain"> </span><span class="token number">300</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--statistics</span><span class="token plain"> Average</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-monitoring">Performance Monitoring<a href="#performance-monitoring" class="hash-link" aria-label="Direct link to Performance Monitoring" title="Direct link to Performance Monitoring">​</a></h3>
<p>Monitor FSx performance through CloudWatch metrics:</p>
<ul>
<li><strong>TotalIOTime</strong>: I/O utilization percentage</li>
<li><strong>DataReadBytes/DataWriteBytes</strong>: Throughput metrics</li>
<li><strong>MetadataOperations</strong>: File system metadata operations</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<p>Once your shared file system is set up:</p>
<ol>
<li><strong>Test with sample workloads</strong> to verify performance</li>
<li><strong>Configure data repository associations</strong> with S3 if needed</li>
<li><strong>Set up monitoring and alerting</strong> for FSx metrics</li>
<li><strong>Review the training blueprints</strong> that leverage FSx for distributed training</li>
</ol>
<p>For advanced FSx configuration and management, see:</p>
<ul>
<li><a href="/ai-on-sagemaker-hyperpod/docs/Tips/Common/link-fsx-to-S3">Link FSx to S3</a></li>
<li><a href="/ai-on-sagemaker-hyperpod/docs/Tips/Common/mount-additional-fsx">Mount additional FSx filesystems</a></li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/additional-information"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Additional Information</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/Adding a Data Repository Assocation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding a Data Repository Association</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-shared-file-systems-matter" class="table-of-contents__link toc-highlight">Why Shared File Systems Matter</a><ul><li><a href="#performance-impact" class="table-of-contents__link toc-highlight">Performance Impact</a></li><li><a href="#fsx-for-lustre-benefits" class="table-of-contents__link toc-highlight">FSx for Lustre Benefits</a></li></ul></li><li><a href="#setup-options" class="table-of-contents__link toc-highlight">Setup Options</a><ul><li><a href="#option-1-auto-provisioned-console-quick-setup" class="table-of-contents__link toc-highlight">Option 1: Auto-Provisioned (Console Quick Setup)</a></li><li><a href="#option-2-manual-setup-dynamic-provisioning" class="table-of-contents__link toc-highlight">Option 2: Manual Setup (Dynamic Provisioning)</a></li><li><a href="#option-3-bring-your-own-fsx-static-provisioning" class="table-of-contents__link toc-highlight">Option 3: Bring Your Own FSx (Static Provisioning)</a></li></ul></li><li><a href="#using-fsx-in-eks-jobs" class="table-of-contents__link toc-highlight">Using FSx in EKS Jobs</a><ul><li><a href="#mount-points-and-paths" class="table-of-contents__link toc-highlight">Mount Points and Paths</a></li><li><a href="#best-practices-for-data-access" class="table-of-contents__link toc-highlight">Best Practices for Data Access</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#common-issues" class="table-of-contents__link toc-highlight">Common Issues</a></li><li><a href="#performance-monitoring" class="table-of-contents__link toc-highlight">Performance Monitoring</a></li></ul></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-eks/initial-cluster-setup">Orchestrated by EKS</a></li><li class="footer__item"><a class="footer__link-item" href="/ai-on-sagemaker-hyperpod/docs/getting-started/orchestrated-by-slurm/initial-cluster-setup">Orchestrated by SLURM</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Sites with Sagemaker AI content</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/aws-samples/awsome-distributed-training" target="_blank" rel="noopener noreferrer" class="footer__link-item">Awsome Distributed Training<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/aws/sagemaker-hyperpod-recipes" target="_blank" rel="noopener noreferrer" class="footer__link-item">SageMaker HyperPod Recipes<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Other AWS related sites</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://aws.training" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS Training &amp; Certification<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://aws.amazon.com/sagemaker/ai/hyperpod" target="_blank" rel="noopener noreferrer" class="footer__link-item">Amazon SageMaker HyperPod<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://repost.aws" target="_blank" rel="noopener noreferrer" class="footer__link-item">AWS re:Post<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 AWS WWSO ML Frameworks team. Built with ❤️ at AWS.</div></div></div></footer></div>
</body>
</html>